{
  "cve": "CVE-2024-47191",
  "mitre": {
    "cpes": [],
    "created": "2024-10-09T00:00:00+00:00",
    "description": "pam_oath.so in oath-toolkit 2.6.7 through 2.6.11 before 2.6.12 allows root privilege escalation because, in the context of PAM code running as root, it mishandles usersfile access, such as by calling fchown in the presence of a symlink.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/47xxx/CVE-2024-47191.json",
    "references": [
      "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3235a52f6b87cd1c5da6508f421ac261f5e33a70",
      "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3271139989fde35ab0163b558fc29e80c3a280e5",
      "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a",
      "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/95ef255e6a401949ce3f67609bf8aac2029db418",
      "https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43",
      "https://security.opensuse.org/2024/10/04/oath-toolkit-vulnerability.html",
      "https://www.nongnu.org/oath-toolkit/security/CVE-2024-47191",
      "https://www.openwall.com/lists/oss-security/2024/10/04/2"
    ],
    "title": null,
    "updated": "2024-10-09T05:08:49.223530+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-10-05T01:30:00+00:00",
        "data": [
          {
            "details": {
              "new": "No description is available for this CVE.",
              "old": null
            },
            "type": "description"
          },
          {
            "details": {
              "new": "oath-toolkit: Local root exploit in a PAM module",
              "old": null
            },
            "type": "title"
          },
          {
            "details": {
              "added": [
                "CWE-22"
              ],
              "removed": []
            },
            "type": "weaknesses"
          },
          {
            "details": {
              "added": [
                "https://nvd.nist.gov/vuln/detail/CVE-2024-47191",
                "https://www.cve.org/CVERecord?id=CVE-2024-47191"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {
                "cvssV3_1": {
                  "score": 7.1,
                  "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
                }
              },
              "removed": {},
              "updated": {
                "threat_severity": {
                  "new": "Important",
                  "old": null
                }
              }
            },
            "type": "metrics"
          }
        ],
        "id": "4019359c-daf3-4e9f-9e7d-08e9c0d890cb"
      },
      {
        "created": "2024-10-08T02:30:00+00:00",
        "data": [
          {
            "details": {
              "new": "A vulnerability was found in a PAM module, the oath-toolkit. The module gained a feature that allowed placing the OTP state file, called the usersfile, in the home directory of the to-be-authenticated user. The PAM module performed unsafe file operations in the users' home directories. Since PAM stacks typically run as root, this flaw allows a malicious user to jeopardize an environment.",
              "old": "No description is available for this CVE."
            },
            "type": "description"
          }
        ],
        "id": "df38a2b5-7bbd-4ba9-a62e-b066d4228240"
      },
      {
        "created": "2024-10-09T05:15:00+00:00",
        "data": [
          {
            "details": {
              "new": "pam_oath.so in oath-toolkit 2.6.7 through 2.6.11 before 2.6.12 allows root privilege escalation because, in the context of PAM code running as root, it mishandles usersfile access, such as by calling fchown in the presence of a symlink.",
              "old": "A vulnerability was found in a PAM module, the oath-toolkit. The module gained a feature that allowed placing the OTP state file, called the usersfile, in the home directory of the to-be-authenticated user. The PAM module performed unsafe file operations in the users' home directories. Since PAM stacks typically run as root, this flaw allows a malicious user to jeopardize an environment."
            },
            "type": "description"
          },
          {
            "details": {
              "added": [
                "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3235a52f6b87cd1c5da6508f421ac261f5e33a70",
                "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3271139989fde35ab0163b558fc29e80c3a280e5",
                "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a",
                "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/95ef255e6a401949ce3f67609bf8aac2029db418",
                "https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43",
                "https://security.opensuse.org/2024/10/04/oath-toolkit-vulnerability.html",
                "https://www.nongnu.org/oath-toolkit/security/CVE-2024-47191",
                "https://www.openwall.com/lists/oss-security/2024/10/04/2"
              ],
              "removed": []
            },
            "type": "references"
          }
        ],
        "id": "5c58bc5f-5004-4d0a-be33-0b89778dab75"
      }
    ],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-10-04T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "pam_oath.so in oath-toolkit 2.6.7 through 2.6.11 before 2.6.12 allows root privilege escalation because, in the context of PAM code running as root, it mishandles usersfile access, such as by calling fchown in the presence of a symlink.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 7.1,
          "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Important",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3235a52f6b87cd1c5da6508f421ac261f5e33a70",
        "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/3271139989fde35ab0163b558fc29e80c3a280e5",
        "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/60d9902b5c20f27e70f8e9c816bfdc0467567e1a",
        "https://gitlab.com/oath-toolkit/oath-toolkit/-/commit/95ef255e6a401949ce3f67609bf8aac2029db418",
        "https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43",
        "https://nvd.nist.gov/vuln/detail/CVE-2024-47191",
        "https://security.opensuse.org/2024/10/04/oath-toolkit-vulnerability.html",
        "https://www.cve.org/CVERecord?id=CVE-2024-47191",
        "https://www.nongnu.org/oath-toolkit/security/CVE-2024-47191",
        "https://www.openwall.com/lists/oss-security/2024/10/04/2"
      ],
      "providers": [
        "mitre",
        "redhat"
      ]
    },
    "title": {
      "data": "oath-toolkit: Local root exploit in a PAM module",
      "provider": "nvd"
    },
    "updated": {
      "data": "2024-10-09T05:08:49.223530+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-22"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-10-04T00:00:00+00:00",
    "description": "A vulnerability was found in a PAM module, the oath-toolkit. The module gained a feature that allowed placing the OTP state file, called the usersfile, in the home directory of the to-be-authenticated user. The PAM module performed unsafe file operations in the users' home directories. Since PAM stacks typically run as root, this flaw allows a malicious user to jeopardize an environment.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 7.1,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
      },
      "threat_severity": "Important"
    },
    "redhat_repo_path": "2024/CVE-2024-47191.json",
    "references": [
      "https://nvd.nist.gov/vuln/detail/CVE-2024-47191",
      "https://www.cve.org/CVERecord?id=CVE-2024-47191"
    ],
    "title": "oath-toolkit: Local root exploit in a PAM module",
    "updated": "2024-10-04T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-22"
    ]
  }
}