{
  "cve": "CVE-2023-4680",
  "mitre": {
    "cpes": [],
    "created": "2023-09-14T23:06:24.546000+00:00",
    "description": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.8,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2023/4xxx/CVE-2023-4680.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249"
    ],
    "title": "Vault's Transit Secrets Engine Allowed Nonce Specified without Convergent Encryption",
    "updated": "2024-09-26T16:53:53.489000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-323"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
      "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*"
    ],
    "created": "2023-09-15T00:15:07.967000+00:00",
    "description": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.8,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2023/CVE-2023-4680.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249"
    ],
    "title": null,
    "updated": "2024-09-26T17:15:03.190000+00:00",
    "vendors": [
      "hashicorp",
      "hashicorp$PRODUCT$vault"
    ],
    "weaknesses": [
      "CWE-20",
      "CWE-323"
    ]
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-08-27T14:45:00+00:00",
        "data": [
          {
            "details": {
              "added": [
                "https://github.com/advisories/GHSA-v84f-6r39-cpfc",
                "https://nvd.nist.gov/vuln/detail/CVE-2023-4680",
                "https://www.cve.org/CVERecord?id=CVE-2023-4680"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {},
              "removed": {},
              "updated": {
                "threat_severity": {
                  "new": "Moderate",
                  "old": null
                }
              }
            },
            "type": "metrics"
          }
        ],
        "id": "d384c4b3-0b19-4baf-a3e5-9735ffdb39d0"
      },
      {
        "created": "2024-09-25T20:30:00+00:00",
        "data": [
          {
            "details": [
              "hashicorp$PRODUCT$vault_enterprise"
            ],
            "type": "first_time"
          },
          {
            "details": {
              "added": [
                "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
              ],
              "removed": []
            },
            "type": "cpes"
          },
          {
            "details": {
              "added": [
                "hashicorp$PRODUCT$vault_enterprise"
              ],
              "removed": []
            },
            "type": "vendors"
          },
          {
            "details": {
              "added": {
                "ssvc": {
                  "options": {
                    "Automatable": "no",
                    "Exploitation": "none",
                    "Technical Impact": "total"
                  },
                  "version": "2.0.3"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "78781bf2-1031-4602-aac3-7fde5423e912"
      },
      {
        "created": "2024-09-26T17:00:00+00:00",
        "data": [
          {
            "details": {
              "added": [
                "CWE-323"
              ],
              "removed": []
            },
            "type": "weaknesses"
          }
        ],
        "id": "8890ad70-1f28-4a74-8b82-3af04f04ac36"
      }
    ],
    "cpes": {
      "data": [
        "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
        "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "created": {
      "data": "2023-09-14T23:06:24.546000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 6.8,
          "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {
          "options": {
            "Automatable": "no",
            "Exploitation": "none",
            "Technical Impact": "total"
          },
          "version": "2.0.3"
        },
        "provider": "vulnrichment"
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249",
        "https://github.com/advisories/GHSA-v84f-6r39-cpfc",
        "https://nvd.nist.gov/vuln/detail/CVE-2023-4680",
        "https://www.cve.org/CVERecord?id=CVE-2023-4680"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "Vault's Transit Secrets Engine Allowed Nonce Specified without Convergent Encryption",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-09-26T17:15:03.190000+00:00",
      "provider": "nvd"
    },
    "vendors": {
      "data": [
        "hashicorp",
        "hashicorp$PRODUCT$vault",
        "hashicorp$PRODUCT$vault_enterprise"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-20",
        "CWE-323"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2023-11-06T00:00:00+00:00",
    "description": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.8,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2023/CVE-2023-4680.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249",
      "https://github.com/advisories/GHSA-v84f-6r39-cpfc",
      "https://nvd.nist.gov/vuln/detail/CVE-2023-4680",
      "https://www.cve.org/CVERecord?id=CVE-2023-4680"
    ],
    "title": "vault: HashiCorp Vault Improper Input Validation vulnerability in github.com/hashicorp/vault",
    "updated": "2023-11-06T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-20"
    ]
  },
  "vulnrichment": {
    "cpes": [
      "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
      "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
    ],
    "created": "2023-09-14T23:06:24.546000+00:00",
    "description": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {
        "options": {
          "Automatable": "no",
          "Exploitation": "none",
          "Technical Impact": "total"
        },
        "version": "2.0.3"
      }
    },
    "references": [],
    "title": "Vault's Transit Secrets Engine Allowed Nonce Specified without Convergent Encryption",
    "updated": "2024-09-25T19:58:23.754000+00:00",
    "vendors": [
      "hashicorp",
      "hashicorp$PRODUCT$vault",
      "hashicorp$PRODUCT$vault_enterprise"
    ],
    "vulnrichment_repo_path": "2023/4xxx/CVE-2023-4680.json",
    "weaknesses": []
  }
}