{
  "cve": "CVE-2021-47328",
  "mitre": {
    "cpes": [],
    "created": "2024-05-21T14:35:40.479000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: Fix conn use after free during resets\n\nIf we haven't done a unbind target call we can race where\niscsi_conn_teardown wakes up the EH thread and then frees the conn while\nthose threads are still accessing the conn ehwait.\n\nWe can only do one TMF per session so this just moves the TMF fields from\nthe conn to the session. We can then rely on the\niscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call\nto remove the target and it's devices, and know after that point there is\nno device or scsi-ml callout trying to access the session.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/47xxx/CVE-2021-47328.json",
    "references": [
      "https://git.kernel.org/stable/c/89812e7957ab0746eab66ed6fc49d52bb4dca250",
      "https://git.kernel.org/stable/c/bf20d85a88384574fabb3d53ad62a8af57e7ab11",
      "https://git.kernel.org/stable/c/d04958a348e560938410e04a12fb99da9c7e6a00",
      "https://git.kernel.org/stable/c/ec29d0ac29be366450a7faffbcf8cba3a6a3b506",
      "https://git.kernel.org/stable/c/f0a031f7c55ffd944fead1ddaf2aa94df9a158c1",
      "https://git.kernel.org/stable/c/fa9542b35ceb4202e8f8d65f440529a63524dca9"
    ],
    "title": "scsi: iscsi: Fix conn use after free during resets",
    "updated": "2024-08-04T05:32:08.445000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-05-21T15:15:19.823000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: Fix conn use after free during resets\n\nIf we haven't done a unbind target call we can race where\niscsi_conn_teardown wakes up the EH thread and then frees the conn while\nthose threads are still accessing the conn ehwait.\n\nWe can only do one TMF per session so this just moves the TMF fields from\nthe conn to the session. We can then rely on the\niscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call\nto remove the target and it's devices, and know after that point there is\nno device or scsi-ml callout trying to access the session.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-47328.json",
    "references": [
      "https://git.kernel.org/stable/c/89812e7957ab0746eab66ed6fc49d52bb4dca250",
      "https://git.kernel.org/stable/c/bf20d85a88384574fabb3d53ad62a8af57e7ab11",
      "https://git.kernel.org/stable/c/d04958a348e560938410e04a12fb99da9c7e6a00",
      "https://git.kernel.org/stable/c/ec29d0ac29be366450a7faffbcf8cba3a6a3b506",
      "https://git.kernel.org/stable/c/f0a031f7c55ffd944fead1ddaf2aa94df9a158c1",
      "https://git.kernel.org/stable/c/fa9542b35ceb4202e8f8d65f440529a63524dca9"
    ],
    "title": null,
    "updated": "2024-05-21T16:54:26.047000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-05-21T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: Fix conn use after free during resets\n\nIf we haven't done a unbind target call we can race where\niscsi_conn_teardown wakes up the EH thread and then frees the conn while\nthose threads are still accessing the conn ehwait.\n\nWe can only do one TMF per session so this just moves the TMF fields from\nthe conn to the session. We can then rely on the\niscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call\nto remove the target and it's devices, and know after that point there is\nno device or scsi-ml callout trying to access the session.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.2,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/89812e7957ab0746eab66ed6fc49d52bb4dca250",
        "https://git.kernel.org/stable/c/bf20d85a88384574fabb3d53ad62a8af57e7ab11",
        "https://git.kernel.org/stable/c/d04958a348e560938410e04a12fb99da9c7e6a00",
        "https://git.kernel.org/stable/c/ec29d0ac29be366450a7faffbcf8cba3a6a3b506",
        "https://git.kernel.org/stable/c/f0a031f7c55ffd944fead1ddaf2aa94df9a158c1",
        "https://git.kernel.org/stable/c/fa9542b35ceb4202e8f8d65f440529a63524dca9",
        "https://lore.kernel.org/linux-cve-announce/2024052134-CVE-2021-47328-441f@gregkh/T",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-47328",
        "https://www.cve.org/CVERecord?id=CVE-2021-47328"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat",
        "vulnrichment"
      ]
    },
    "title": {
      "data": "scsi: iscsi: Fix conn use after free during resets",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T05:32:08.445000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-416"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-05-21T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nscsi: iscsi: Fix conn use after free during resets\nIf we haven't done a unbind target call we can race where\niscsi_conn_teardown wakes up the EH thread and then frees the conn while\nthose threads are still accessing the conn ehwait.\nWe can only do one TMF per session so this just moves the TMF fields from\nthe conn to the session. We can then rely on the\niscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call\nto remove the target and it's devices, and know after that point there is\nno device or scsi-ml callout trying to access the session.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.2,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2021/CVE-2021-47328.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024052134-CVE-2021-47328-441f@gregkh/T",
      "https://nvd.nist.gov/vuln/detail/CVE-2021-47328",
      "https://www.cve.org/CVERecord?id=CVE-2021-47328"
    ],
    "title": "kernel: scsi: iscsi: Fix conn use after free during resets",
    "updated": "2024-05-21T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-416"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-05-21T14:35:40.479000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: Fix conn use after free during resets\n\nIf we haven't done a unbind target call we can race where\niscsi_conn_teardown wakes up the EH thread and then frees the conn while\nthose threads are still accessing the conn ehwait.\n\nWe can only do one TMF per session so this just moves the TMF fields from\nthe conn to the session. We can then rely on the\niscsi_session_teardown->iscsi_remove_session->__iscsi_unbind_session call\nto remove the target and it's devices, and know after that point there is\nno device or scsi-ml callout trying to access the session.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {}
    },
    "references": [
      "https://git.kernel.org/stable/c/89812e7957ab0746eab66ed6fc49d52bb4dca250",
      "https://git.kernel.org/stable/c/bf20d85a88384574fabb3d53ad62a8af57e7ab11",
      "https://git.kernel.org/stable/c/d04958a348e560938410e04a12fb99da9c7e6a00",
      "https://git.kernel.org/stable/c/ec29d0ac29be366450a7faffbcf8cba3a6a3b506",
      "https://git.kernel.org/stable/c/f0a031f7c55ffd944fead1ddaf2aa94df9a158c1",
      "https://git.kernel.org/stable/c/fa9542b35ceb4202e8f8d65f440529a63524dca9"
    ],
    "title": "scsi: iscsi: Fix conn use after free during resets",
    "updated": "2024-08-04T05:32:08.445000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2021/47xxx/CVE-2021-47328.json",
    "weaknesses": []
  }
}