{
  "cve": "CVE-2022-31151",
  "mitre": {
    "cpes": [],
    "created": "2022-07-20T23:00:15+00:00",
    "description": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default).",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 3.7,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2022/31xxx/CVE-2022-31151.json",
    "references": [
      "https://github.com/nodejs/undici/issues/872",
      "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp",
      "https://hackerone.com/reports/1635514",
      "https://security.netapp.com/advisory/ntap-20220909-0006/"
    ],
    "title": "Uncleared cookies on cross-host/cross-origin redirect in undici",
    "updated": "2024-08-03T07:11:39.602000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-601"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*"
    ],
    "created": "2022-07-21T04:15:12.157000+00:00",
    "description": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default).",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.5,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2022/CVE-2022-31151.json",
    "references": [
      "https://github.com/nodejs/undici/issues/872",
      "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp",
      "https://hackerone.com/reports/1635514",
      "https://security.netapp.com/advisory/ntap-20220909-0006/"
    ],
    "title": null,
    "updated": "2022-09-29T15:40:23.837000+00:00",
    "vendors": [
      "nodejs",
      "nodejs$PRODUCT$undici"
    ],
    "weaknesses": [
      "CWE-346",
      "CWE-601"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:/a:redhat:acm:2.4::el8",
        "cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*"
      ],
      "providers": [
        "nvd",
        "redhat"
      ]
    },
    "created": {
      "data": "2022-07-20T23:00:15+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default).",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 3.7,
          "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31151",
        "https://github.com/nodejs/undici/issues/872",
        "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp",
        "https://hackerone.com/reports/1635514",
        "https://nvd.nist.gov/vuln/detail/CVE-2022-31151",
        "https://security.netapp.com/advisory/ntap-20220909-0006/",
        "https://www.cve.org/CVERecord?id=CVE-2022-31151"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "Uncleared cookies on cross-host/cross-origin redirect in undici",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-03T07:11:39.602000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "nodejs",
        "nodejs$PRODUCT$undici",
        "redhat",
        "redhat$PRODUCT$acm"
      ],
      "providers": [
        "nvd",
        "redhat"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-200",
        "CWE-346",
        "CWE-601"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [
      "cpe:/a:redhat:acm:2.4::el8"
    ],
    "created": "2022-07-21T00:00:00+00:00",
    "description": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default).",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 3.7,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2022/CVE-2022-31151.json",
    "references": [
      "http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-31151",
      "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp",
      "https://nvd.nist.gov/vuln/detail/CVE-2022-31151",
      "https://www.cve.org/CVERecord?id=CVE-2022-31151"
    ],
    "title": "nodejs/undici: Cookie headers uncleared on cross-origin redirect",
    "updated": "2022-07-21T00:00:00+00:00",
    "vendors": [
      "redhat",
      "redhat$PRODUCT$acm"
    ],
    "weaknesses": [
      "CWE-200"
    ]
  }
}