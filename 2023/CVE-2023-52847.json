{
  "cve": "CVE-2023-52847",
  "mitre": {
    "cpes": [],
    "created": "2024-05-21T15:31:44.513000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: bttv: fix use after free error due to btv->timeout timer\n\nThere may be some a race condition between timer function\nbttv_irq_timeout and bttv_remove. The timer is setup in\nprobe and there is no timer_delete operation in remove\nfunction. When it hit kfree btv, the function might still be\ninvoked, which will cause use after free bug.\n\nThis bug is found by static analysis, it may be false positive.\n\nFix it by adding del_timer_sync invoking to the remove function.\n\ncpu0                cpu1\n                  bttv_probe\n                    ->timer_setup\n                      ->bttv_set_dma\n                        ->mod_timer;\nbttv_remove\n  ->kfree(btv);\n                  ->bttv_irq_timeout\n                    ->USE btv",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2023/52xxx/CVE-2023-52847.json",
    "references": [
      "https://git.kernel.org/stable/c/1871014d6ef4812ad11ef7d838d73ce09d632267",
      "https://git.kernel.org/stable/c/20568d06f6069cb835e05eed432edf962645d226",
      "https://git.kernel.org/stable/c/2f3d9198cdae1cb079ec8652f4defacd481eab2b",
      "https://git.kernel.org/stable/c/51c94256a83fe4e17406c66ff3e1ad7d242d8574",
      "https://git.kernel.org/stable/c/847599fffa528b2cdec4e21b6bf7586dad982132",
      "https://git.kernel.org/stable/c/b35fdade92c5058a5e727e233fe263b828de2c9a",
      "https://git.kernel.org/stable/c/bbc3b8dd2cb7817e703f112d988e4f4728f0f2a9",
      "https://git.kernel.org/stable/c/bd5b50b329e850d467e7bcc07b2b6bde3752fbda"
    ],
    "title": "media: bttv: fix use after free error due to btv->timeout timer",
    "updated": "2024-08-02T23:11:36.080000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-05-21T16:15:21.873000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: bttv: fix use after free error due to btv->timeout timer\n\nThere may be some a race condition between timer function\nbttv_irq_timeout and bttv_remove. The timer is setup in\nprobe and there is no timer_delete operation in remove\nfunction. When it hit kfree btv, the function might still be\ninvoked, which will cause use after free bug.\n\nThis bug is found by static analysis, it may be false positive.\n\nFix it by adding del_timer_sync invoking to the remove function.\n\ncpu0                cpu1\n                  bttv_probe\n                    ->timer_setup\n                      ->bttv_set_dma\n                        ->mod_timer;\nbttv_remove\n  ->kfree(btv);\n                  ->bttv_irq_timeout\n                    ->USE btv",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2023/CVE-2023-52847.json",
    "references": [
      "https://git.kernel.org/stable/c/1871014d6ef4812ad11ef7d838d73ce09d632267",
      "https://git.kernel.org/stable/c/20568d06f6069cb835e05eed432edf962645d226",
      "https://git.kernel.org/stable/c/2f3d9198cdae1cb079ec8652f4defacd481eab2b",
      "https://git.kernel.org/stable/c/51c94256a83fe4e17406c66ff3e1ad7d242d8574",
      "https://git.kernel.org/stable/c/847599fffa528b2cdec4e21b6bf7586dad982132",
      "https://git.kernel.org/stable/c/b35fdade92c5058a5e727e233fe263b828de2c9a",
      "https://git.kernel.org/stable/c/bbc3b8dd2cb7817e703f112d988e4f4728f0f2a9",
      "https://git.kernel.org/stable/c/bd5b50b329e850d467e7bcc07b2b6bde3752fbda"
    ],
    "title": null,
    "updated": "2024-05-21T16:53:56.550000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-05-21T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: bttv: fix use after free error due to btv->timeout timer\n\nThere may be some a race condition between timer function\nbttv_irq_timeout and bttv_remove. The timer is setup in\nprobe and there is no timer_delete operation in remove\nfunction. When it hit kfree btv, the function might still be\ninvoked, which will cause use after free bug.\n\nThis bug is found by static analysis, it may be false positive.\n\nFix it by adding del_timer_sync invoking to the remove function.\n\ncpu0                cpu1\n                  bttv_probe\n                    ->timer_setup\n                      ->bttv_set_dma\n                        ->mod_timer;\nbttv_remove\n  ->kfree(btv);\n                  ->bttv_irq_timeout\n                    ->USE btv",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.2,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Low",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/1871014d6ef4812ad11ef7d838d73ce09d632267",
        "https://git.kernel.org/stable/c/20568d06f6069cb835e05eed432edf962645d226",
        "https://git.kernel.org/stable/c/2f3d9198cdae1cb079ec8652f4defacd481eab2b",
        "https://git.kernel.org/stable/c/51c94256a83fe4e17406c66ff3e1ad7d242d8574",
        "https://git.kernel.org/stable/c/847599fffa528b2cdec4e21b6bf7586dad982132",
        "https://git.kernel.org/stable/c/b35fdade92c5058a5e727e233fe263b828de2c9a",
        "https://git.kernel.org/stable/c/bbc3b8dd2cb7817e703f112d988e4f4728f0f2a9",
        "https://git.kernel.org/stable/c/bd5b50b329e850d467e7bcc07b2b6bde3752fbda",
        "https://lore.kernel.org/linux-cve-announce/2024052113-CVE-2023-52847-a551@gregkh/T",
        "https://nvd.nist.gov/vuln/detail/CVE-2023-52847",
        "https://www.cve.org/CVERecord?id=CVE-2023-52847"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat",
        "vulnrichment"
      ]
    },
    "title": {
      "data": "media: bttv: fix use after free error due to btv->timeout timer",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-02T23:11:36.080000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-416"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-05-21T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nmedia: bttv: fix use after free error due to btv->timeout timer\nThere may be some a race condition between timer function\nbttv_irq_timeout and bttv_remove. The timer is setup in\nprobe and there is no timer_delete operation in remove\nfunction. When it hit kfree btv, the function might still be\ninvoked, which will cause use after free bug.\nThis bug is found by static analysis, it may be false positive.\nFix it by adding del_timer_sync invoking to the remove function.\ncpu0                cpu1\nbttv_probe\n->timer_setup\n->bttv_set_dma\n->mod_timer;\nbttv_remove\n->kfree(btv);\n->bttv_irq_timeout\n->USE btv",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.2,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
      },
      "threat_severity": "Low"
    },
    "redhat_repo_path": "2023/CVE-2023-52847.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024052113-CVE-2023-52847-a551@gregkh/T",
      "https://nvd.nist.gov/vuln/detail/CVE-2023-52847",
      "https://www.cve.org/CVERecord?id=CVE-2023-52847"
    ],
    "title": "kernel: media: bttv: fix use after free error due to btv->timeout timer",
    "updated": "2024-05-21T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-416"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-05-21T15:31:44.513000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: bttv: fix use after free error due to btv->timeout timer\n\nThere may be some a race condition between timer function\nbttv_irq_timeout and bttv_remove. The timer is setup in\nprobe and there is no timer_delete operation in remove\nfunction. When it hit kfree btv, the function might still be\ninvoked, which will cause use after free bug.\n\nThis bug is found by static analysis, it may be false positive.\n\nFix it by adding del_timer_sync invoking to the remove function.\n\ncpu0                cpu1\n                  bttv_probe\n                    ->timer_setup\n                      ->bttv_set_dma\n                        ->mod_timer;\nbttv_remove\n  ->kfree(btv);\n                  ->bttv_irq_timeout\n                    ->USE btv",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {}
    },
    "references": [
      "https://git.kernel.org/stable/c/1871014d6ef4812ad11ef7d838d73ce09d632267",
      "https://git.kernel.org/stable/c/20568d06f6069cb835e05eed432edf962645d226",
      "https://git.kernel.org/stable/c/2f3d9198cdae1cb079ec8652f4defacd481eab2b",
      "https://git.kernel.org/stable/c/51c94256a83fe4e17406c66ff3e1ad7d242d8574",
      "https://git.kernel.org/stable/c/847599fffa528b2cdec4e21b6bf7586dad982132",
      "https://git.kernel.org/stable/c/b35fdade92c5058a5e727e233fe263b828de2c9a",
      "https://git.kernel.org/stable/c/bbc3b8dd2cb7817e703f112d988e4f4728f0f2a9",
      "https://git.kernel.org/stable/c/bd5b50b329e850d467e7bcc07b2b6bde3752fbda"
    ],
    "title": "media: bttv: fix use after free error due to btv->timeout timer",
    "updated": "2024-08-02T23:11:36.080000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2023/52xxx/CVE-2023-52847.json",
    "weaknesses": []
  }
}