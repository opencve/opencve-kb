{
  "cve": "CVE-2024-7594",
  "mitre": {
    "cpes": [],
    "created": "2024-09-26T19:52:55.652000+00:00",
    "description": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 7.5,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/7xxx/CVE-2024-7594.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251"
    ],
    "title": "Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By Default",
    "updated": "2024-09-26T20:29:58.984000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-732"
    ]
  },
  "nvd": {
    "cpes": [],
    "created": "2024-09-26T20:15:07.687000+00:00",
    "description": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 7.5,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2024/CVE-2024-7594.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251"
    ],
    "title": null,
    "updated": "2024-09-26T20:15:07.687000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-732"
    ]
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-09-26T20:00:00+00:00",
        "data": [
          {
            "details": {
              "new": "Vault’s SSH secrets engine did not require the {{valid_principals}} list to contain a value by default. If the {{valid_principals}} and {{default_user}} fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
              "old": null
            },
            "type": "description"
          },
          {
            "details": {
              "new": "Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By Default",
              "old": null
            },
            "type": "title"
          },
          {
            "details": {
              "added": [
                "CWE-732"
              ],
              "removed": []
            },
            "type": "weaknesses"
          },
          {
            "details": {
              "added": [
                "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {
                "cvssV3_1": {
                  "score": 7.5,
                  "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "5e57712f-6af8-46ac-801e-2c8f9aaf0e57"
      },
      {
        "created": "2024-09-26T20:15:00+00:00",
        "data": [
          {
            "details": {
              "new": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
              "old": "Vault’s SSH secrets engine did not require the {{valid_principals}} list to contain a value by default. If the {{valid_principals}} and {{default_user}} fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15."
            },
            "type": "description"
          }
        ],
        "id": "ee310b8b-3201-41f1-9a7a-084b39097335"
      },
      {
        "created": "2024-09-26T21:30:00+00:00",
        "data": [
          {
            "details": [
              "hashicorp",
              "hashicorp$PRODUCT$vault_community_edition",
              "hashicorp$PRODUCT$vault_enterprise"
            ],
            "type": "first_time"
          },
          {
            "details": {
              "added": [
                "cpe:2.3:a:hashicorp:vault_community_edition:*:*:*:*:*:*:*:*",
                "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
              ],
              "removed": []
            },
            "type": "cpes"
          },
          {
            "details": {
              "added": [
                "hashicorp",
                "hashicorp$PRODUCT$vault_community_edition",
                "hashicorp$PRODUCT$vault_enterprise"
              ],
              "removed": []
            },
            "type": "vendors"
          },
          {
            "details": {
              "added": {
                "ssvc": {
                  "options": {
                    "Automatable": "no",
                    "Exploitation": "none",
                    "Technical Impact": "total"
                  },
                  "version": "2.0.3"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "05a981ec-757e-4379-a3a3-d05bea498c0c"
      },
      {
        "created": "2024-09-27T01:30:00+00:00",
        "data": [
          {
            "details": {
              "added": [
                "https://nvd.nist.gov/vuln/detail/CVE-2024-7594",
                "https://www.cve.org/CVERecord?id=CVE-2024-7594"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {},
              "removed": {},
              "updated": {
                "threat_severity": {
                  "new": "Moderate",
                  "old": null
                }
              }
            },
            "type": "metrics"
          }
        ],
        "id": "d2502686-5639-4ed6-bb30-d03df163a42b"
      }
    ],
    "cpes": {
      "data": [
        "cpe:2.3:a:hashicorp:vault_community_edition:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "vulnrichment"
      ]
    },
    "created": {
      "data": "2024-09-26T19:52:55.652000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 7.5,
          "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {
          "options": {
            "Automatable": "no",
            "Exploitation": "none",
            "Technical Impact": "total"
          },
          "version": "2.0.3"
        },
        "provider": "vulnrichment"
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251",
        "https://nvd.nist.gov/vuln/detail/CVE-2024-7594",
        "https://www.cve.org/CVERecord?id=CVE-2024-7594"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By Default",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-09-26T20:29:58.984000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "hashicorp",
        "hashicorp$PRODUCT$vault_community_edition",
        "hashicorp$PRODUCT$vault_enterprise"
      ],
      "providers": [
        "vulnrichment"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-732"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-09-26T20:15:07+00:00",
    "description": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 7.5,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2024/CVE-2024-7594.json",
    "references": [
      "https://discuss.hashicorp.com/t/hcsec-2024-20-vault-ssh-secrets-engine-configuration-did-not-restrict-valid-principals-by-default/70251",
      "https://nvd.nist.gov/vuln/detail/CVE-2024-7594",
      "https://www.cve.org/CVERecord?id=CVE-2024-7594"
    ],
    "title": "hashicorp/vault: Vault SSH secrets engine configuration did not restrict valid principals by default",
    "updated": "2024-09-26T20:15:07+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-732"
    ]
  },
  "vulnrichment": {
    "cpes": [
      "cpe:2.3:a:hashicorp:vault_community_edition:*:*:*:*:*:*:*:*",
      "cpe:2.3:a:hashicorp:vault_enterprise:*:*:*:*:*:*:*:*"
    ],
    "created": "2024-09-26T19:52:55.652000+00:00",
    "description": "Vault’s SSH secrets engine did not require the valid_principals list to contain a value by default. If the valid_principals and default_user fields of the SSH secrets engine configuration are not set, an SSH certificate requested by an authorized user to Vault’s SSH secrets engine could be used to authenticate as any user on the host. Fixed in Vault Community Edition 1.17.6, and in Vault Enterprise 1.17.6, 1.16.10, and 1.15.15.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {
        "options": {
          "Automatable": "no",
          "Exploitation": "none",
          "Technical Impact": "total"
        },
        "version": "2.0.3"
      }
    },
    "references": [],
    "title": "Vault SSH Secrets Engine Configuration Did Not Restrict Valid Principals By Default",
    "updated": "2024-09-26T20:27:27.031000+00:00",
    "vendors": [
      "hashicorp",
      "hashicorp$PRODUCT$vault_community_edition",
      "hashicorp$PRODUCT$vault_enterprise"
    ],
    "vulnrichment_repo_path": "2024/7xxx/CVE-2024-7594.json",
    "weaknesses": []
  }
}