{
  "cve": "CVE-2021-46956",
  "mitre": {
    "cpes": [],
    "created": "2024-02-27T18:46:58.101000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtiofs: fix memory leak in virtio_fs_probe()\n\nWhen accidentally passing twice the same tag to qemu, kmemleak ended up\nreporting a memory leak in virtiofs.  Also, looking at the log I saw the\nfollowing error (that's when I realised the duplicated tag):\n\n  virtiofs: probe of virtio5 failed with error -17\n\nHere's the kmemleak log for reference:\n\nunreferenced object 0xffff888103d47800 (size 1024):\n  comm \"systemd-udevd\", pid 118, jiffies 4294893780 (age 18.340s)\n  hex dump (first 32 bytes):\n    00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\n    ff ff ff ff ff ff ff ff 80 90 02 a0 ff ff ff ff  ................\n  backtrace:\n    [<000000000ebb87c1>] virtio_fs_probe+0x171/0x7ae [virtiofs]\n    [<00000000f8aca419>] virtio_dev_probe+0x15f/0x210\n    [<000000004d6baf3c>] really_probe+0xea/0x430\n    [<00000000a6ceeac8>] device_driver_attach+0xa8/0xb0\n    [<00000000196f47a7>] __driver_attach+0x98/0x140\n    [<000000000b20601d>] bus_for_each_dev+0x7b/0xc0\n    [<00000000399c7b7f>] bus_add_driver+0x11b/0x1f0\n    [<0000000032b09ba7>] driver_register+0x8f/0xe0\n    [<00000000cdd55998>] 0xffffffffa002c013\n    [<000000000ea196a2>] do_one_initcall+0x64/0x2e0\n    [<0000000008f727ce>] do_init_module+0x5c/0x260\n    [<000000003cdedab6>] __do_sys_finit_module+0xb5/0x120\n    [<00000000ad2f48c6>] do_syscall_64+0x33/0x40\n    [<00000000809526b5>] entry_SYSCALL_64_after_hwframe+0x44/0xae",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/46xxx/CVE-2021-46956.json",
    "references": [
      "https://git.kernel.org/stable/c/310efc95c72c13faf855c692d19cd4d054d827c8",
      "https://git.kernel.org/stable/c/5116e79fc6e6725b8acdad8b7e928a83ab7b47e6",
      "https://git.kernel.org/stable/c/9b9d60c0eb8ada99cce2a9ab5c15dffc523b01ae",
      "https://git.kernel.org/stable/c/c79c5e0178922a9e092ec8fed026750f39dcaef4",
      "https://git.kernel.org/stable/c/d19555ff225d0896a33246a49279e6d578095f15"
    ],
    "title": "virtiofs: fix memory leak in virtio_fs_probe()",
    "updated": "2024-08-04T05:17:42.907000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-02-27T19:04:06.717000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtiofs: fix memory leak in virtio_fs_probe()\n\nWhen accidentally passing twice the same tag to qemu, kmemleak ended up\nreporting a memory leak in virtiofs.  Also, looking at the log I saw the\nfollowing error (that's when I realised the duplicated tag):\n\n  virtiofs: probe of virtio5 failed with error -17\n\nHere's the kmemleak log for reference:\n\nunreferenced object 0xffff888103d47800 (size 1024):\n  comm \"systemd-udevd\", pid 118, jiffies 4294893780 (age 18.340s)\n  hex dump (first 32 bytes):\n    00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\n    ff ff ff ff ff ff ff ff 80 90 02 a0 ff ff ff ff  ................\n  backtrace:\n    [<000000000ebb87c1>] virtio_fs_probe+0x171/0x7ae [virtiofs]\n    [<00000000f8aca419>] virtio_dev_probe+0x15f/0x210\n    [<000000004d6baf3c>] really_probe+0xea/0x430\n    [<00000000a6ceeac8>] device_driver_attach+0xa8/0xb0\n    [<00000000196f47a7>] __driver_attach+0x98/0x140\n    [<000000000b20601d>] bus_for_each_dev+0x7b/0xc0\n    [<00000000399c7b7f>] bus_add_driver+0x11b/0x1f0\n    [<0000000032b09ba7>] driver_register+0x8f/0xe0\n    [<00000000cdd55998>] 0xffffffffa002c013\n    [<000000000ea196a2>] do_one_initcall+0x64/0x2e0\n    [<0000000008f727ce>] do_init_module+0x5c/0x260\n    [<000000003cdedab6>] __do_sys_finit_module+0xb5/0x120\n    [<00000000ad2f48c6>] do_syscall_64+0x33/0x40\n    [<00000000809526b5>] entry_SYSCALL_64_after_hwframe+0x44/0xae",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-46956.json",
    "references": [
      "https://git.kernel.org/stable/c/310efc95c72c13faf855c692d19cd4d054d827c8",
      "https://git.kernel.org/stable/c/5116e79fc6e6725b8acdad8b7e928a83ab7b47e6",
      "https://git.kernel.org/stable/c/9b9d60c0eb8ada99cce2a9ab5c15dffc523b01ae",
      "https://git.kernel.org/stable/c/c79c5e0178922a9e092ec8fed026750f39dcaef4",
      "https://git.kernel.org/stable/c/d19555ff225d0896a33246a49279e6d578095f15"
    ],
    "title": null,
    "updated": "2024-02-28T14:06:45.783000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-02-27T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtiofs: fix memory leak in virtio_fs_probe()\n\nWhen accidentally passing twice the same tag to qemu, kmemleak ended up\nreporting a memory leak in virtiofs.  Also, looking at the log I saw the\nfollowing error (that's when I realised the duplicated tag):\n\n  virtiofs: probe of virtio5 failed with error -17\n\nHere's the kmemleak log for reference:\n\nunreferenced object 0xffff888103d47800 (size 1024):\n  comm \"systemd-udevd\", pid 118, jiffies 4294893780 (age 18.340s)\n  hex dump (first 32 bytes):\n    00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\n    ff ff ff ff ff ff ff ff 80 90 02 a0 ff ff ff ff  ................\n  backtrace:\n    [<000000000ebb87c1>] virtio_fs_probe+0x171/0x7ae [virtiofs]\n    [<00000000f8aca419>] virtio_dev_probe+0x15f/0x210\n    [<000000004d6baf3c>] really_probe+0xea/0x430\n    [<00000000a6ceeac8>] device_driver_attach+0xa8/0xb0\n    [<00000000196f47a7>] __driver_attach+0x98/0x140\n    [<000000000b20601d>] bus_for_each_dev+0x7b/0xc0\n    [<00000000399c7b7f>] bus_add_driver+0x11b/0x1f0\n    [<0000000032b09ba7>] driver_register+0x8f/0xe0\n    [<00000000cdd55998>] 0xffffffffa002c013\n    [<000000000ea196a2>] do_one_initcall+0x64/0x2e0\n    [<0000000008f727ce>] do_init_module+0x5c/0x260\n    [<000000003cdedab6>] __do_sys_finit_module+0xb5/0x120\n    [<00000000ad2f48c6>] do_syscall_64+0x33/0x40\n    [<00000000809526b5>] entry_SYSCALL_64_after_hwframe+0x44/0xae",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 4.7,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Low",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/310efc95c72c13faf855c692d19cd4d054d827c8",
        "https://git.kernel.org/stable/c/5116e79fc6e6725b8acdad8b7e928a83ab7b47e6",
        "https://git.kernel.org/stable/c/9b9d60c0eb8ada99cce2a9ab5c15dffc523b01ae",
        "https://git.kernel.org/stable/c/c79c5e0178922a9e092ec8fed026750f39dcaef4",
        "https://git.kernel.org/stable/c/d19555ff225d0896a33246a49279e6d578095f15",
        "https://lore.kernel.org/linux-cve-announce/2024022718-CVE-2021-46956-df60@gregkh/T/#u",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-46956",
        "https://www.cve.org/CVERecord?id=CVE-2021-46956"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat",
        "vulnrichment"
      ]
    },
    "title": {
      "data": "virtiofs: fix memory leak in virtio_fs_probe()",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T05:17:42.907000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-401"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-02-27T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nvirtiofs: fix memory leak in virtio_fs_probe()\nWhen accidentally passing twice the same tag to qemu, kmemleak ended up\nreporting a memory leak in virtiofs.  Also, looking at the log I saw the\nfollowing error (that's when I realised the duplicated tag):\nvirtiofs: probe of virtio5 failed with error -17\nHere's the kmemleak log for reference:\nunreferenced object 0xffff888103d47800 (size 1024):\ncomm \"systemd-udevd\", pid 118, jiffies 4294893780 (age 18.340s)\nhex dump (first 32 bytes):\n00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\nff ff ff ff ff ff ff ff 80 90 02 a0 ff ff ff ff  ................\nbacktrace:\n[<000000000ebb87c1>] virtio_fs_probe+0x171/0x7ae [virtiofs]\n[<00000000f8aca419>] virtio_dev_probe+0x15f/0x210\n[<000000004d6baf3c>] really_probe+0xea/0x430\n[<00000000a6ceeac8>] device_driver_attach+0xa8/0xb0\n[<00000000196f47a7>] __driver_attach+0x98/0x140\n[<000000000b20601d>] bus_for_each_dev+0x7b/0xc0\n[<00000000399c7b7f>] bus_add_driver+0x11b/0x1f0\n[<0000000032b09ba7>] driver_register+0x8f/0xe0\n[<00000000cdd55998>] 0xffffffffa002c013\n[<000000000ea196a2>] do_one_initcall+0x64/0x2e0\n[<0000000008f727ce>] do_init_module+0x5c/0x260\n[<000000003cdedab6>] __do_sys_finit_module+0xb5/0x120\n[<00000000ad2f48c6>] do_syscall_64+0x33/0x40\n[<00000000809526b5>] entry_SYSCALL_64_after_hwframe+0x44/0xae",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 4.7,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"
      },
      "threat_severity": "Low"
    },
    "redhat_repo_path": "2021/CVE-2021-46956.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024022718-CVE-2021-46956-df60@gregkh/T/#u",
      "https://nvd.nist.gov/vuln/detail/CVE-2021-46956",
      "https://www.cve.org/CVERecord?id=CVE-2021-46956"
    ],
    "title": "kernel: virtiofs: fix memory leak in virtio_fs_probe()",
    "updated": "2024-02-27T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-401"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-02-27T18:46:58.101000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtiofs: fix memory leak in virtio_fs_probe()\n\nWhen accidentally passing twice the same tag to qemu, kmemleak ended up\nreporting a memory leak in virtiofs.  Also, looking at the log I saw the\nfollowing error (that's when I realised the duplicated tag):\n\n  virtiofs: probe of virtio5 failed with error -17\n\nHere's the kmemleak log for reference:\n\nunreferenced object 0xffff888103d47800 (size 1024):\n  comm \"systemd-udevd\", pid 118, jiffies 4294893780 (age 18.340s)\n  hex dump (first 32 bytes):\n    00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\n    ff ff ff ff ff ff ff ff 80 90 02 a0 ff ff ff ff  ................\n  backtrace:\n    [<000000000ebb87c1>] virtio_fs_probe+0x171/0x7ae [virtiofs]\n    [<00000000f8aca419>] virtio_dev_probe+0x15f/0x210\n    [<000000004d6baf3c>] really_probe+0xea/0x430\n    [<00000000a6ceeac8>] device_driver_attach+0xa8/0xb0\n    [<00000000196f47a7>] __driver_attach+0x98/0x140\n    [<000000000b20601d>] bus_for_each_dev+0x7b/0xc0\n    [<00000000399c7b7f>] bus_add_driver+0x11b/0x1f0\n    [<0000000032b09ba7>] driver_register+0x8f/0xe0\n    [<00000000cdd55998>] 0xffffffffa002c013\n    [<000000000ea196a2>] do_one_initcall+0x64/0x2e0\n    [<0000000008f727ce>] do_init_module+0x5c/0x260\n    [<000000003cdedab6>] __do_sys_finit_module+0xb5/0x120\n    [<00000000ad2f48c6>] do_syscall_64+0x33/0x40\n    [<00000000809526b5>] entry_SYSCALL_64_after_hwframe+0x44/0xae",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {}
    },
    "references": [
      "https://git.kernel.org/stable/c/310efc95c72c13faf855c692d19cd4d054d827c8",
      "https://git.kernel.org/stable/c/5116e79fc6e6725b8acdad8b7e928a83ab7b47e6",
      "https://git.kernel.org/stable/c/9b9d60c0eb8ada99cce2a9ab5c15dffc523b01ae",
      "https://git.kernel.org/stable/c/c79c5e0178922a9e092ec8fed026750f39dcaef4",
      "https://git.kernel.org/stable/c/d19555ff225d0896a33246a49279e6d578095f15"
    ],
    "title": "virtiofs: fix memory leak in virtio_fs_probe()",
    "updated": "2024-08-04T05:17:42.907000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2021/46xxx/CVE-2021-46956.json",
    "weaknesses": []
  }
}