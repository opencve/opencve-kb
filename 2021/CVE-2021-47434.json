{
  "cve": "CVE-2021-47434",
  "mitre": {
    "cpes": [],
    "created": "2024-05-22T06:19:30.896000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nxhci: Fix command ring pointer corruption while aborting a command\n\nThe command ring pointer is located at [6:63] bits of the command\nring control register (CRCR). All the control bits like command stop,\nabort are located at [0:3] bits. While aborting a command, we read the\nCRCR and set the abort bit and write to the CRCR. The read will always\ngive command ring pointer as all zeros. So we essentially write only\nthe control bits. Since we split the 64 bit write into two 32 bit writes,\nthere is a possibility of xHC command ring stopped before the upper\ndword (all zeros) is written. If that happens, xHC updates the upper\ndword of its internal command ring pointer with all zeros. Next time,\nwhen the command ring is restarted, we see xHC memory access failures.\nFix this issue by only writing to the lower dword of CRCR where all\ncontrol bits are located.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/47xxx/CVE-2021-47434.json",
    "references": [
      "https://git.kernel.org/stable/c/01c2dcb67e71c351006dd17cbba86c26b7f61eaf",
      "https://git.kernel.org/stable/c/22bcb65ea41072ab5d03c0c6290e04e0df6d09a0",
      "https://git.kernel.org/stable/c/62c182b5e763e5f4062e72678e72ce3e02dd4d1b",
      "https://git.kernel.org/stable/c/dec944bb7079b37968cf69c8a438f91f15c4cc61",
      "https://git.kernel.org/stable/c/e54abefe703ab7c4e5983e889babd1447738ca42",
      "https://git.kernel.org/stable/c/ff0e50d3564f33b7f4b35cadeabd951d66cfc570"
    ],
    "title": "xhci: Fix command ring pointer corruption while aborting a command",
    "updated": "2024-08-04T05:39:59.365000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-05-22T07:15:08.707000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nxhci: Fix command ring pointer corruption while aborting a command\n\nThe command ring pointer is located at [6:63] bits of the command\nring control register (CRCR). All the control bits like command stop,\nabort are located at [0:3] bits. While aborting a command, we read the\nCRCR and set the abort bit and write to the CRCR. The read will always\ngive command ring pointer as all zeros. So we essentially write only\nthe control bits. Since we split the 64 bit write into two 32 bit writes,\nthere is a possibility of xHC command ring stopped before the upper\ndword (all zeros) is written. If that happens, xHC updates the upper\ndword of its internal command ring pointer with all zeros. Next time,\nwhen the command ring is restarted, we see xHC memory access failures.\nFix this issue by only writing to the lower dword of CRCR where all\ncontrol bits are located.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-47434.json",
    "references": [
      "https://git.kernel.org/stable/c/01c2dcb67e71c351006dd17cbba86c26b7f61eaf",
      "https://git.kernel.org/stable/c/22bcb65ea41072ab5d03c0c6290e04e0df6d09a0",
      "https://git.kernel.org/stable/c/62c182b5e763e5f4062e72678e72ce3e02dd4d1b",
      "https://git.kernel.org/stable/c/dec944bb7079b37968cf69c8a438f91f15c4cc61",
      "https://git.kernel.org/stable/c/e54abefe703ab7c4e5983e889babd1447738ca42",
      "https://git.kernel.org/stable/c/ff0e50d3564f33b7f4b35cadeabd951d66cfc570"
    ],
    "title": null,
    "updated": "2024-05-22T12:46:53.887000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-05-22T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nxhci: Fix command ring pointer corruption while aborting a command\n\nThe command ring pointer is located at [6:63] bits of the command\nring control register (CRCR). All the control bits like command stop,\nabort are located at [0:3] bits. While aborting a command, we read the\nCRCR and set the abort bit and write to the CRCR. The read will always\ngive command ring pointer as all zeros. So we essentially write only\nthe control bits. Since we split the 64 bit write into two 32 bit writes,\nthere is a possibility of xHC command ring stopped before the upper\ndword (all zeros) is written. If that happens, xHC updates the upper\ndword of its internal command ring pointer with all zeros. Next time,\nwhen the command ring is restarted, we see xHC memory access failures.\nFix this issue by only writing to the lower dword of CRCR where all\ncontrol bits are located.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.1,
          "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Low",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/01c2dcb67e71c351006dd17cbba86c26b7f61eaf",
        "https://git.kernel.org/stable/c/22bcb65ea41072ab5d03c0c6290e04e0df6d09a0",
        "https://git.kernel.org/stable/c/62c182b5e763e5f4062e72678e72ce3e02dd4d1b",
        "https://git.kernel.org/stable/c/dec944bb7079b37968cf69c8a438f91f15c4cc61",
        "https://git.kernel.org/stable/c/e54abefe703ab7c4e5983e889babd1447738ca42",
        "https://git.kernel.org/stable/c/ff0e50d3564f33b7f4b35cadeabd951d66cfc570",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-47434",
        "https://www.cve.org/CVERecord?id=CVE-2021-47434"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat",
        "vulnrichment"
      ]
    },
    "title": {
      "data": "xhci: Fix command ring pointer corruption while aborting a command",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T05:39:59.365000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-822"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-05-22T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nxhci: Fix command ring pointer corruption while aborting a command\nThe command ring pointer is located at [6:63] bits of the command\nring control register (CRCR). All the control bits like command stop,\nabort are located at [0:3] bits. While aborting a command, we read the\nCRCR and set the abort bit and write to the CRCR. The read will always\ngive command ring pointer as all zeros. So we essentially write only\nthe control bits. Since we split the 64 bit write into two 32 bit writes,\nthere is a possibility of xHC command ring stopped before the upper\ndword (all zeros) is written. If that happens, xHC updates the upper\ndword of its internal command ring pointer with all zeros. Next time,\nwhen the command ring is restarted, we see xHC memory access failures.\nFix this issue by only writing to the lower dword of CRCR where all\ncontrol bits are located.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.1,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:H"
      },
      "threat_severity": "Low"
    },
    "redhat_repo_path": "2021/CVE-2021-47434.json",
    "references": [
      "https://nvd.nist.gov/vuln/detail/CVE-2021-47434",
      "https://www.cve.org/CVERecord?id=CVE-2021-47434"
    ],
    "title": "kernel: xhci: Fix command ring pointer corruption while aborting a command",
    "updated": "2024-05-22T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-822"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-05-22T06:19:30.896000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nxhci: Fix command ring pointer corruption while aborting a command\n\nThe command ring pointer is located at [6:63] bits of the command\nring control register (CRCR). All the control bits like command stop,\nabort are located at [0:3] bits. While aborting a command, we read the\nCRCR and set the abort bit and write to the CRCR. The read will always\ngive command ring pointer as all zeros. So we essentially write only\nthe control bits. Since we split the 64 bit write into two 32 bit writes,\nthere is a possibility of xHC command ring stopped before the upper\ndword (all zeros) is written. If that happens, xHC updates the upper\ndword of its internal command ring pointer with all zeros. Next time,\nwhen the command ring is restarted, we see xHC memory access failures.\nFix this issue by only writing to the lower dword of CRCR where all\ncontrol bits are located.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {}
    },
    "references": [
      "https://git.kernel.org/stable/c/01c2dcb67e71c351006dd17cbba86c26b7f61eaf",
      "https://git.kernel.org/stable/c/22bcb65ea41072ab5d03c0c6290e04e0df6d09a0",
      "https://git.kernel.org/stable/c/62c182b5e763e5f4062e72678e72ce3e02dd4d1b",
      "https://git.kernel.org/stable/c/dec944bb7079b37968cf69c8a438f91f15c4cc61",
      "https://git.kernel.org/stable/c/e54abefe703ab7c4e5983e889babd1447738ca42",
      "https://git.kernel.org/stable/c/ff0e50d3564f33b7f4b35cadeabd951d66cfc570"
    ],
    "title": "xhci: Fix command ring pointer corruption while aborting a command",
    "updated": "2024-08-04T05:39:59.365000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2021/47xxx/CVE-2021-47434.json",
    "weaknesses": []
  }
}