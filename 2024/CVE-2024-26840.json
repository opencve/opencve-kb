{
  "cve": "CVE-2024-26840",
  "mitre": {
    "cpes": [],
    "created": "2024-04-17T10:10:06.180000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: fix memory leak in cachefiles_add_cache()\n\nThe following memory leak was reported after unbinding /dev/cachefiles:\n\n==================================================================\nunreferenced object 0xffff9b674176e3c0 (size 192):\n  comm \"cachefilesd2\", pid 680, jiffies 4294881224\n  hex dump (first 32 bytes):\n    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc ea38a44b):\n    [<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370\n    [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0\n    [<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120\n    [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0\n    [<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0\n    [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520\n    [<ffffffff8ebc5069>] ksys_write+0x69/0xf0\n    [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140\n    [<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76\n==================================================================\n\nPut the reference count of cache_cred in cachefiles_daemon_unbind() to\nfix the problem. And also put cache_cred in cachefiles_add_cache() error\nbranch to avoid memory leaks.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/26xxx/CVE-2024-26840.json",
    "references": [
      "https://git.kernel.org/stable/c/037d5a949b0455540ef9aab34c10ddf54b65d285",
      "https://git.kernel.org/stable/c/38e921616320d159336b0ffadb09e9fb4945c7c3",
      "https://git.kernel.org/stable/c/43eccc5823732ba6daab2511ed32dfc545a666d8",
      "https://git.kernel.org/stable/c/8b218e2f0a27a9f09428b1847b4580640b9d1e58",
      "https://git.kernel.org/stable/c/94965be37add0983672e48ecb33cdbda92b62579",
      "https://git.kernel.org/stable/c/9cac69912052a4def571fedf1cb9bb4ec590e25a",
      "https://git.kernel.org/stable/c/cb5466783793e66272624cf71925ae1d1ba32083",
      "https://git.kernel.org/stable/c/e21a2f17566cbd64926fb8f16323972f7a064444",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html"
    ],
    "title": "cachefiles: fix memory leak in cachefiles_add_cache()",
    "updated": "2024-08-02T00:14:13.702000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-04-17T10:15:09.910000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: fix memory leak in cachefiles_add_cache()\n\nThe following memory leak was reported after unbinding /dev/cachefiles:\n\n==================================================================\nunreferenced object 0xffff9b674176e3c0 (size 192):\n  comm \"cachefilesd2\", pid 680, jiffies 4294881224\n  hex dump (first 32 bytes):\n    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc ea38a44b):\n    [<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370\n    [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0\n    [<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120\n    [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0\n    [<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0\n    [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520\n    [<ffffffff8ebc5069>] ksys_write+0x69/0xf0\n    [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140\n    [<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76\n==================================================================\n\nPut the reference count of cache_cred in cachefiles_daemon_unbind() to\nfix the problem. And also put cache_cred in cachefiles_add_cache() error\nbranch to avoid memory leaks.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2024/CVE-2024-26840.json",
    "references": [
      "https://git.kernel.org/stable/c/037d5a949b0455540ef9aab34c10ddf54b65d285",
      "https://git.kernel.org/stable/c/38e921616320d159336b0ffadb09e9fb4945c7c3",
      "https://git.kernel.org/stable/c/43eccc5823732ba6daab2511ed32dfc545a666d8",
      "https://git.kernel.org/stable/c/8b218e2f0a27a9f09428b1847b4580640b9d1e58",
      "https://git.kernel.org/stable/c/94965be37add0983672e48ecb33cdbda92b62579",
      "https://git.kernel.org/stable/c/9cac69912052a4def571fedf1cb9bb4ec590e25a",
      "https://git.kernel.org/stable/c/cb5466783793e66272624cf71925ae1d1ba32083",
      "https://git.kernel.org/stable/c/e21a2f17566cbd64926fb8f16323972f7a064444",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html"
    ],
    "title": null,
    "updated": "2024-06-27T13:15:56.713000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-04-17T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: fix memory leak in cachefiles_add_cache()\n\nThe following memory leak was reported after unbinding /dev/cachefiles:\n\n==================================================================\nunreferenced object 0xffff9b674176e3c0 (size 192):\n  comm \"cachefilesd2\", pid 680, jiffies 4294881224\n  hex dump (first 32 bytes):\n    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc ea38a44b):\n    [<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370\n    [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0\n    [<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120\n    [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0\n    [<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0\n    [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520\n    [<ffffffff8ebc5069>] ksys_write+0x69/0xf0\n    [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140\n    [<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76\n==================================================================\n\nPut the reference count of cache_cred in cachefiles_daemon_unbind() to\nfix the problem. And also put cache_cred in cachefiles_add_cache() error\nbranch to avoid memory leaks.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.5,
          "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Low",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/037d5a949b0455540ef9aab34c10ddf54b65d285",
        "https://git.kernel.org/stable/c/38e921616320d159336b0ffadb09e9fb4945c7c3",
        "https://git.kernel.org/stable/c/43eccc5823732ba6daab2511ed32dfc545a666d8",
        "https://git.kernel.org/stable/c/8b218e2f0a27a9f09428b1847b4580640b9d1e58",
        "https://git.kernel.org/stable/c/94965be37add0983672e48ecb33cdbda92b62579",
        "https://git.kernel.org/stable/c/9cac69912052a4def571fedf1cb9bb4ec590e25a",
        "https://git.kernel.org/stable/c/cb5466783793e66272624cf71925ae1d1ba32083",
        "https://git.kernel.org/stable/c/e21a2f17566cbd64926fb8f16323972f7a064444",
        "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html",
        "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html",
        "https://lore.kernel.org/linux-cve-announce/2024041715-CVE-2024-26840-057d@gregkh/T",
        "https://nvd.nist.gov/vuln/detail/CVE-2024-26840",
        "https://www.cve.org/CVERecord?id=CVE-2024-26840"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat",
        "vulnrichment"
      ]
    },
    "title": {
      "data": "cachefiles: fix memory leak in cachefiles_add_cache()",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-02T00:14:13.702000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-402"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-04-17T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\ncachefiles: fix memory leak in cachefiles_add_cache()\nThe following memory leak was reported after unbinding /dev/cachefiles:\n==================================================================\nunreferenced object 0xffff9b674176e3c0 (size 192):\ncomm \"cachefilesd2\", pid 680, jiffies 4294881224\nhex dump (first 32 bytes):\n01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\nbacktrace (crc ea38a44b):\n[<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370\n[<ffffffff8e917f86>] prepare_creds+0x26/0x2e0\n[<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120\n[<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0\n[<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0\n[<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520\n[<ffffffff8ebc5069>] ksys_write+0x69/0xf0\n[<ffffffff8f6d4662>] do_syscall_64+0x72/0x140\n[<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76\n==================================================================\nPut the reference count of cache_cred in cachefiles_daemon_unbind() to\nfix the problem. And also put cache_cred in cachefiles_add_cache() error\nbranch to avoid memory leaks.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.5,
        "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
      },
      "threat_severity": "Low"
    },
    "redhat_repo_path": "2024/CVE-2024-26840.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024041715-CVE-2024-26840-057d@gregkh/T",
      "https://nvd.nist.gov/vuln/detail/CVE-2024-26840",
      "https://www.cve.org/CVERecord?id=CVE-2024-26840"
    ],
    "title": "kernel: cachefiles: fix memory leak in cachefiles_add_cache()",
    "updated": "2024-04-17T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-402"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-04-17T10:10:06.180000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: fix memory leak in cachefiles_add_cache()\n\nThe following memory leak was reported after unbinding /dev/cachefiles:\n\n==================================================================\nunreferenced object 0xffff9b674176e3c0 (size 192):\n  comm \"cachefilesd2\", pid 680, jiffies 4294881224\n  hex dump (first 32 bytes):\n    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc ea38a44b):\n    [<ffffffff8eb8a1a5>] kmem_cache_alloc+0x2d5/0x370\n    [<ffffffff8e917f86>] prepare_creds+0x26/0x2e0\n    [<ffffffffc002eeef>] cachefiles_determine_cache_security+0x1f/0x120\n    [<ffffffffc00243ec>] cachefiles_add_cache+0x13c/0x3a0\n    [<ffffffffc0025216>] cachefiles_daemon_write+0x146/0x1c0\n    [<ffffffff8ebc4a3b>] vfs_write+0xcb/0x520\n    [<ffffffff8ebc5069>] ksys_write+0x69/0xf0\n    [<ffffffff8f6d4662>] do_syscall_64+0x72/0x140\n    [<ffffffff8f8000aa>] entry_SYSCALL_64_after_hwframe+0x6e/0x76\n==================================================================\n\nPut the reference count of cache_cred in cachefiles_daemon_unbind() to\nfix the problem. And also put cache_cred in cachefiles_add_cache() error\nbranch to avoid memory leaks.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {}
    },
    "references": [
      "https://git.kernel.org/stable/c/037d5a949b0455540ef9aab34c10ddf54b65d285",
      "https://git.kernel.org/stable/c/38e921616320d159336b0ffadb09e9fb4945c7c3",
      "https://git.kernel.org/stable/c/43eccc5823732ba6daab2511ed32dfc545a666d8",
      "https://git.kernel.org/stable/c/8b218e2f0a27a9f09428b1847b4580640b9d1e58",
      "https://git.kernel.org/stable/c/94965be37add0983672e48ecb33cdbda92b62579",
      "https://git.kernel.org/stable/c/9cac69912052a4def571fedf1cb9bb4ec590e25a",
      "https://git.kernel.org/stable/c/cb5466783793e66272624cf71925ae1d1ba32083",
      "https://git.kernel.org/stable/c/e21a2f17566cbd64926fb8f16323972f7a064444",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html"
    ],
    "title": "cachefiles: fix memory leak in cachefiles_add_cache()",
    "updated": "2024-08-02T00:14:13.702000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2024/26xxx/CVE-2024-26840.json",
    "weaknesses": []
  }
}