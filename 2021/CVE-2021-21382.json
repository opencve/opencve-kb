{
  "cve": "CVE-2021-21382",
  "mitre": {
    "cpes": [],
    "created": "2021-06-11T20:50:14+00:00",
    "description": "Restund is an open source NAT traversal server. The restund TURN server can be instructed to open a relay to the loopback address range. This allows you to reach any other service running on localhost which you might consider private. In the configuration that we ship (https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43) the `status` interface of restund is enabled and is listening on `127.0.0.1`.The `status` interface allows users to issue administrative commands to `restund` like listing open relays or draining connections. It would be possible for an attacker to contact the status interface and issue administrative commands by setting `XOR-PEER-ADDRESS` to `127.0.0.1:{{restund_udp_status_port}}` when opening a TURN channel. We now explicitly disallow relaying to loopback addresses, 'any' addresses, link local addresses, and the broadcast address. As a workaround disable the `status` module in your restund configuration. However there might still be other services running on `127.0.0.0/8` that you do not want to have exposed. The `turn` module can be disabled. Restund will still perform STUN and this might already be enough for initiating calls in your environments. TURN is only used as a last resort when other NAT traversal options do not work. One should also make sure that the TURN server is set up with firewall rules so that it cannot relay to other addresses that you don't want the TURN server to relay to. For example other services in the same VPC where the TURN server is running. Ideally TURN servers should be deployed in an isolated fashion where they can only reach what they need to reach to perform their task of assisting NAT-traversal.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 8.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/21xxx/CVE-2021-21382.json",
    "references": [
      "https://docs.wire.com/understand/restund.html",
      "https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p",
      "https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43",
      "https://github.com/wireapp/restund/pull/7",
      "https://github.com/wireapp/restund/security/advisories/GHSA-96j5-w9jq-pv2x",
      "https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732",
      "https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else"
    ],
    "title": "Unsafe loopback forwarding interface in Restund",
    "updated": "2024-08-03T18:09:16.047000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-668"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:wire:restund:*:*:*:*:*:*:*:*"
    ],
    "created": "2021-06-11T21:15:09.637000+00:00",
    "description": "Restund is an open source NAT traversal server. The restund TURN server can be instructed to open a relay to the loopback address range. This allows you to reach any other service running on localhost which you might consider private. In the configuration that we ship (https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43) the `status` interface of restund is enabled and is listening on `127.0.0.1`.The `status` interface allows users to issue administrative commands to `restund` like listing open relays or draining connections. It would be possible for an attacker to contact the status interface and issue administrative commands by setting `XOR-PEER-ADDRESS` to `127.0.0.1:{{restund_udp_status_port}}` when opening a TURN channel. We now explicitly disallow relaying to loopback addresses, 'any' addresses, link local addresses, and the broadcast address. As a workaround disable the `status` module in your restund configuration. However there might still be other services running on `127.0.0.0/8` that you do not want to have exposed. The `turn` module can be disabled. Restund will still perform STUN and this might already be enough for initiating calls in your environments. TURN is only used as a last resort when other NAT traversal options do not work. One should also make sure that the TURN server is set up with firewall rules so that it cannot relay to other addresses that you don't want the TURN server to relay to. For example other services in the same VPC where the TURN server is running. Ideally TURN servers should be deployed in an isolated fashion where they can only reach what they need to reach to perform their task of assisting NAT-traversal.",
    "metrics": {
      "cvssV2_0": {
        "score": 5.5,
        "vector": "AV:N/AC:L/Au:S/C:P/I:P/A:N"
      },
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 9.6,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-21382.json",
    "references": [
      "https://docs.wire.com/understand/restund.html",
      "https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p",
      "https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43",
      "https://github.com/wireapp/restund/pull/7",
      "https://github.com/wireapp/restund/security/advisories/GHSA-96j5-w9jq-pv2x",
      "https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732",
      "https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else"
    ],
    "title": null,
    "updated": "2022-10-21T22:44:11.940000+00:00",
    "vendors": [
      "wire",
      "wire$PRODUCT$restund"
    ],
    "weaknesses": [
      "CWE-668",
      "CWE-862"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:2.3:a:wire:restund:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd"
      ]
    },
    "created": {
      "data": "2021-06-11T20:50:14+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Restund is an open source NAT traversal server. The restund TURN server can be instructed to open a relay to the loopback address range. This allows you to reach any other service running on localhost which you might consider private. In the configuration that we ship (https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43) the `status` interface of restund is enabled and is listening on `127.0.0.1`.The `status` interface allows users to issue administrative commands to `restund` like listing open relays or draining connections. It would be possible for an attacker to contact the status interface and issue administrative commands by setting `XOR-PEER-ADDRESS` to `127.0.0.1:{{restund_udp_status_port}}` when opening a TURN channel. We now explicitly disallow relaying to loopback addresses, 'any' addresses, link local addresses, and the broadcast address. As a workaround disable the `status` module in your restund configuration. However there might still be other services running on `127.0.0.0/8` that you do not want to have exposed. The `turn` module can be disabled. Restund will still perform STUN and this might already be enough for initiating calls in your environments. TURN is only used as a last resort when other NAT traversal options do not work. One should also make sure that the TURN server is set up with firewall rules so that it cannot relay to other addresses that you don't want the TURN server to relay to. For example other services in the same VPC where the TURN server is running. Ideally TURN servers should be deployed in an isolated fashion where they can only reach what they need to reach to perform their task of assisting NAT-traversal.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {
          "score": 5.5,
          "vector": "AV:N/AC:L/Au:S/C:P/I:P/A:N"
        },
        "provider": "nvd"
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 8.6,
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": null,
        "provider": null
      }
    },
    "references": {
      "data": [
        "https://docs.wire.com/understand/restund.html",
        "https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p",
        "https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43",
        "https://github.com/wireapp/restund/pull/7",
        "https://github.com/wireapp/restund/security/advisories/GHSA-96j5-w9jq-pv2x",
        "https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732",
        "https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    },
    "title": {
      "data": "Unsafe loopback forwarding interface in Restund",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-03T18:09:16.047000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "wire",
        "wire$PRODUCT$restund"
      ],
      "providers": [
        "nvd"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-668",
        "CWE-862"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    }
  }
}