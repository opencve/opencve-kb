{
  "cve": "CVE-2022-46174",
  "mitre": {
    "cpes": [],
    "created": "2022-12-28T06:46:43.859000+00:00",
    "description": "efs-utils is a set of Utilities for Amazon Elastic File System (EFS). A potential race condition issue exists within the Amazon EFS mount helper in efs-utils versions v1.34.3 and below. When using TLS to mount file systems, the mount helper allocates a local port for stunnel to receive NFS connections prior to applying the TLS tunnel. In affected versions, concurrent mount operations can allocate the same local port, leading to either failed mount operations or an inappropriate mapping from an EFS customer’s local mount points to that customer’s EFS file systems. This issue is patched in version v1.34.4. There is no recommended work around. We recommend affected users update the installed version of efs-utils to v1.34.4 or later.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 4.2,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2022/46xxx/CVE-2022-46174.json",
    "references": [
      "https://github.com/aws/efs-utils/commit/f3a8f88167d55caa2f78aeb72d4dc1987a9ed62d",
      "https://github.com/aws/efs-utils/issues/125",
      "https://github.com/aws/efs-utils/security/advisories/GHSA-4fv8-w65m-3932"
    ],
    "title": "Race condition during concurrent TLS mounts in efs-utils",
    "updated": "2024-08-03T14:24:03.318000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-362"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:amazon:efs-utils:*:*:*:*:*:*:*:*",
      "cpe:2.3:a:amazon:elastic_file_system_container_storage_interface_driver:*:*:*:*:*:go:*:*"
    ],
    "created": "2022-12-28T07:15:08.860000+00:00",
    "description": "efs-utils is a set of Utilities for Amazon Elastic File System (EFS). A potential race condition issue exists within the Amazon EFS mount helper in efs-utils versions v1.34.3 and below. When using TLS to mount file systems, the mount helper allocates a local port for stunnel to receive NFS connections prior to applying the TLS tunnel. In affected versions, concurrent mount operations can allocate the same local port, leading to either failed mount operations or an inappropriate mapping from an EFS customer’s local mount points to that customer’s EFS file systems. This issue is patched in version v1.34.4. There is no recommended work around. We recommend affected users update the installed version of efs-utils to v1.34.4 or later.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 4.2,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2022/CVE-2022-46174.json",
    "references": [
      "https://github.com/aws/efs-utils/commit/f3a8f88167d55caa2f78aeb72d4dc1987a9ed62d",
      "https://github.com/aws/efs-utils/issues/125",
      "https://github.com/aws/efs-utils/security/advisories/GHSA-4fv8-w65m-3932"
    ],
    "title": null,
    "updated": "2023-01-11T16:16:07.343000+00:00",
    "vendors": [
      "amazon",
      "amazon$PRODUCT$efs-utils",
      "amazon$PRODUCT$elastic_file_system_container_storage_interface_driver"
    ],
    "weaknesses": [
      "CWE-362"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:/a:redhat:openshift:4.12::el8",
        "cpe:2.3:a:amazon:efs-utils:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:amazon:elastic_file_system_container_storage_interface_driver:*:*:*:*:*:go:*:*"
      ],
      "providers": [
        "nvd",
        "redhat"
      ]
    },
    "created": {
      "data": "2022-12-28T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "efs-utils is a set of Utilities for Amazon Elastic File System (EFS). A potential race condition issue exists within the Amazon EFS mount helper in efs-utils versions v1.34.3 and below. When using TLS to mount file systems, the mount helper allocates a local port for stunnel to receive NFS connections prior to applying the TLS tunnel. In affected versions, concurrent mount operations can allocate the same local port, leading to either failed mount operations or an inappropriate mapping from an EFS customer’s local mount points to that customer’s EFS file systems. This issue is patched in version v1.34.4. There is no recommended work around. We recommend affected users update the installed version of efs-utils to v1.34.4 or later.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 4.2,
          "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://github.com/aws/efs-utils/commit/f3a8f88167d55caa2f78aeb72d4dc1987a9ed62d",
        "https://github.com/aws/efs-utils/issues/125",
        "https://github.com/aws/efs-utils/security/advisories/GHSA-4fv8-w65m-3932",
        "https://nvd.nist.gov/vuln/detail/CVE-2022-46174",
        "https://www.cve.org/CVERecord?id=CVE-2022-46174"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "Race condition during concurrent TLS mounts in efs-utils",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-03T14:24:03.318000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "amazon",
        "amazon$PRODUCT$efs-utils",
        "amazon$PRODUCT$elastic_file_system_container_storage_interface_driver",
        "redhat",
        "redhat$PRODUCT$openshift"
      ],
      "providers": [
        "nvd",
        "redhat"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-362"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [
      "cpe:/a:redhat:openshift:4.12::el8"
    ],
    "created": "2022-12-28T00:00:00+00:00",
    "description": "efs-utils is a set of Utilities for Amazon Elastic File System (EFS). A potential race condition issue exists within the Amazon EFS mount helper in efs-utils versions v1.34.3 and below. When using TLS to mount file systems, the mount helper allocates a local port for stunnel to receive NFS connections prior to applying the TLS tunnel. In affected versions, concurrent mount operations can allocate the same local port, leading to either failed mount operations or an inappropriate mapping from an EFS customer’s local mount points to that customer’s EFS file systems. This issue is patched in version v1.34.4. There is no recommended work around. We recommend affected users update the installed version of efs-utils to v1.34.4 or later.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.6,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2022/CVE-2022-46174.json",
    "references": [
      "https://github.com/aws/efs-utils/commit/f3a8f88167d55caa2f78aeb72d4dc1987a9ed62d",
      "https://github.com/aws/efs-utils/issues/125",
      "https://github.com/aws/efs-utils/security/advisories/GHSA-4fv8-w65m-3932",
      "https://nvd.nist.gov/vuln/detail/CVE-2022-46174",
      "https://www.cve.org/CVERecord?id=CVE-2022-46174"
    ],
    "title": "aws-efs-utils: Race condition during concurrent TLS mounts in efs-utils and aws-efs-csi-driver",
    "updated": "2022-12-28T00:00:00+00:00",
    "vendors": [
      "redhat",
      "redhat$PRODUCT$openshift"
    ],
    "weaknesses": [
      "CWE-362"
    ]
  }
}