{
  "cve": "CVE-2020-1685",
  "mitre": {
    "cpes": [],
    "created": "2020-10-14T00:00:00+00:00",
    "description": "When configuring stateless firewall filters in Juniper Networks EX4600 and QFX 5000 Series devices using Virtual Extensible LAN protocol (VXLAN), the discard action will fail to discard traffic under certain conditions. Given a firewall filter configuration similar to: family ethernet-switching { filter L2-VLAN { term ALLOW { from { user-vlan-id 100; } then { accept; } } term NON-MATCH { then { discard; } } when there is only one term containing a 'user-vlan-id' match condition, and no other terms in the firewall filter except discard, the discard action for non-matching traffic will only discard traffic with the same VLAN ID specified under 'user-vlan-id'. Other traffic (e.g. VLAN ID 200) will not be discarded. This unexpected behavior can lead to unintended traffic passing through the interface where the firewall filter is applied. This issue only affects systems using VXLANs. This issue affects Juniper Networks Junos OS on QFX5K Series: 18.1 versions prior to 18.1R3-S7, except 18.1R3; 18.2 versions prior to 18.2R2-S7, 18.2R3-S1; 18.3 versions prior to 18.3R1-S5, 18.3R2-S4, 18.3R3; 18.4 versions prior to 18.4R1-S7, 18.4R2-S1, 18.4R3; 19.1 versions prior to 19.1R1-S5, 19.1R2; 19.2 versions prior to 19.2R1-S5, 19.2R2.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.8,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2020/1xxx/CVE-2020-1685.json",
    "references": [
      "https://kb.juniper.net/JSA11082"
    ],
    "title": "Junos OS: EX4600, QFX5K Series: Stateless firewall filter matching 'user-vlan-id' will cause incomplete discard action",
    "updated": "2024-08-04T06:46:29.658000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-203"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:h:juniper:qfx5100:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5110:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5120:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5130:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5200:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5210:-:*:*:*:*:*:*:*",
      "cpe:2.3:h:juniper:qfx5220:-:*:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r1-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.2:r3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r1-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r2-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s5:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1-s6:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:18.4:r2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:r1-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:r1-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:r1-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:r1-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.1:r1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:*",
      "cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:*"
    ],
    "created": "2020-10-16T21:15:14.177000+00:00",
    "description": "When configuring stateless firewall filters in Juniper Networks EX4600 and QFX 5000 Series devices using Virtual Extensible LAN protocol (VXLAN), the discard action will fail to discard traffic under certain conditions. Given a firewall filter configuration similar to: family ethernet-switching { filter L2-VLAN { term ALLOW { from { user-vlan-id 100; } then { accept; } } term NON-MATCH { then { discard; } } when there is only one term containing a 'user-vlan-id' match condition, and no other terms in the firewall filter except discard, the discard action for non-matching traffic will only discard traffic with the same VLAN ID specified under 'user-vlan-id'. Other traffic (e.g. VLAN ID 200) will not be discarded. This unexpected behavior can lead to unintended traffic passing through the interface where the firewall filter is applied. This issue only affects systems using VXLANs. This issue affects Juniper Networks Junos OS on QFX5K Series: 18.1 versions prior to 18.1R3-S7, except 18.1R3; 18.2 versions prior to 18.2R2-S7, 18.2R3-S1; 18.3 versions prior to 18.3R1-S5, 18.3R2-S4, 18.3R3; 18.4 versions prior to 18.4R1-S7, 18.4R2-S1, 18.4R3; 19.1 versions prior to 19.1R1-S5, 19.1R2; 19.2 versions prior to 19.2R1-S5, 19.2R2.",
    "metrics": {
      "cvssV2_0": {
        "score": 5.0,
        "vector": "AV:N/AC:L/Au:N/C:N/I:P/A:N"
      },
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.8,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2020/CVE-2020-1685.json",
    "references": [
      "https://kb.juniper.net/JSA11082"
    ],
    "title": null,
    "updated": "2021-02-05T16:49:04.023000+00:00",
    "vendors": [
      "juniper",
      "juniper$PRODUCT$junos",
      "juniper$PRODUCT$qfx5100",
      "juniper$PRODUCT$qfx5110",
      "juniper$PRODUCT$qfx5120",
      "juniper$PRODUCT$qfx5130",
      "juniper$PRODUCT$qfx5200",
      "juniper$PRODUCT$qfx5210",
      "juniper$PRODUCT$qfx5220"
    ],
    "weaknesses": [
      "CWE-203"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:2.3:h:juniper:qfx5100:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5110:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5120:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5130:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5200:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5210:-:*:*:*:*:*:*:*",
        "cpe:2.3:h:juniper:qfx5220:-:*:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd"
      ]
    },
    "created": {
      "data": "2020-10-14T00:00:00+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "When configuring stateless firewall filters in Juniper Networks EX4600 and QFX 5000 Series devices using Virtual Extensible LAN protocol (VXLAN), the discard action will fail to discard traffic under certain conditions. Given a firewall filter configuration similar to: family ethernet-switching { filter L2-VLAN { term ALLOW { from { user-vlan-id 100; } then { accept; } } term NON-MATCH { then { discard; } } when there is only one term containing a 'user-vlan-id' match condition, and no other terms in the firewall filter except discard, the discard action for non-matching traffic will only discard traffic with the same VLAN ID specified under 'user-vlan-id'. Other traffic (e.g. VLAN ID 200) will not be discarded. This unexpected behavior can lead to unintended traffic passing through the interface where the firewall filter is applied. This issue only affects systems using VXLANs. This issue affects Juniper Networks Junos OS on QFX5K Series: 18.1 versions prior to 18.1R3-S7, except 18.1R3; 18.2 versions prior to 18.2R2-S7, 18.2R3-S1; 18.3 versions prior to 18.3R1-S5, 18.3R2-S4, 18.3R3; 18.4 versions prior to 18.4R1-S7, 18.4R2-S1, 18.4R3; 19.1 versions prior to 19.1R1-S5, 19.1R2; 19.2 versions prior to 19.2R1-S5, 19.2R2.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {
          "score": 5.0,
          "vector": "AV:N/AC:L/Au:N/C:N/I:P/A:N"
        },
        "provider": "nvd"
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.8,
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": null,
        "provider": null
      }
    },
    "references": {
      "data": [
        "https://kb.juniper.net/JSA11082"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    },
    "title": {
      "data": "Junos OS: EX4600, QFX5K Series: Stateless firewall filter matching 'user-vlan-id' will cause incomplete discard action",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T06:46:29.658000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "juniper",
        "juniper$PRODUCT$junos",
        "juniper$PRODUCT$qfx5100",
        "juniper$PRODUCT$qfx5110",
        "juniper$PRODUCT$qfx5120",
        "juniper$PRODUCT$qfx5130",
        "juniper$PRODUCT$qfx5200",
        "juniper$PRODUCT$qfx5210",
        "juniper$PRODUCT$qfx5220"
      ],
      "providers": [
        "nvd"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-203"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    }
  }
}