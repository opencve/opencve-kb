{
  "cve": "CVE-2024-21631",
  "mitre": {
    "cpes": [],
    "created": "2024-01-03T16:55:02.356000+00:00",
    "description": "Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when parsing a URI's components, which may cause integer overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly but could impact applications relying on the URI type for validating user input. The URI type is used in several places in Vapor. A developer may decide to use URI to represent a URL in their application (especially if that URL is then passed to the HTTP Client) and rely on its public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this behavior to trick the application into accepting a URL to an untrusted destination. By padding the port number with zeros, an attacker can cause an integer overflow to occur when the URL authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for this issue. As a workaround, validate user input before parsing as a URI or, if possible, use Foundation's `URL` and `URLComponents` utilities.\n",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.5,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/21xxx/CVE-2024-21631.json",
    "references": [
      "https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70",
      "https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp"
    ],
    "title": "Integer overflow in URI leading to potential host spoofing",
    "updated": "2024-09-18T16:12:34.781000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-1104",
      "CWE-190",
      "CWE-20"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*"
    ],
    "created": "2024-01-03T17:15:12.790000+00:00",
    "description": "Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when parsing a URI's components, which may cause integer overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly but could impact applications relying on the URI type for validating user input. The URI type is used in several places in Vapor. A developer may decide to use URI to represent a URL in their application (especially if that URL is then passed to the HTTP Client) and rely on its public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this behavior to trick the application into accepting a URL to an untrusted destination. By padding the port number with zeros, an attacker can cause an integer overflow to occur when the URL authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for this issue. As a workaround, validate user input before parsing as a URI or, if possible, use Foundation's `URL` and `URLComponents` utilities.\n",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.5,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2024/CVE-2024-21631.json",
    "references": [
      "https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70",
      "https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp"
    ],
    "title": null,
    "updated": "2024-01-10T18:40:48.587000+00:00",
    "vendors": [
      "vapor",
      "vapor$PRODUCT$vapor"
    ],
    "weaknesses": [
      "CWE-1104",
      "CWE-190",
      "CWE-20"
    ]
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-09-18T17:30:00+00:00",
        "data": [
          {
            "details": {
              "added": {
                "ssvc": {
                  "options": {
                    "Automatable": "yes",
                    "Exploitation": "none",
                    "Technical Impact": "partial"
                  },
                  "version": "2.0.3"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "da324ac1-2272-4b03-918f-730f7a8d6ec9"
      }
    ],
    "cpes": {
      "data": [
        "cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "created": {
      "data": "2024-01-03T16:55:02.356000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when parsing a URI's components, which may cause integer overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly but could impact applications relying on the URI type for validating user input. The URI type is used in several places in Vapor. A developer may decide to use URI to represent a URL in their application (especially if that URL is then passed to the HTTP Client) and rely on its public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this behavior to trick the application into accepting a URL to an untrusted destination. By padding the port number with zeros, an attacker can cause an integer overflow to occur when the URL authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for this issue. As a workaround, validate user input before parsing as a URI or, if possible, use Foundation's `URL` and `URLComponents` utilities.\n",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 6.5,
          "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {
          "options": {
            "Automatable": "yes",
            "Exploitation": "none",
            "Technical Impact": "partial"
          },
          "version": "2.0.3"
        },
        "provider": "vulnrichment"
      },
      "threat_severity": {
        "data": null,
        "provider": null
      }
    },
    "references": {
      "data": [
        "https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70",
        "https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    },
    "title": {
      "data": "Integer overflow in URI leading to potential host spoofing",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-09-18T16:12:34.781000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "vapor",
        "vapor$PRODUCT$vapor"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-1104",
        "CWE-190",
        "CWE-20"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    }
  },
  "vulnrichment": {
    "cpes": [
      "cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*"
    ],
    "created": "2024-01-03T16:55:02.356000+00:00",
    "description": "Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when parsing a URI's components, which may cause integer overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly but could impact applications relying on the URI type for validating user input. The URI type is used in several places in Vapor. A developer may decide to use URI to represent a URL in their application (especially if that URL is then passed to the HTTP Client) and rely on its public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this behavior to trick the application into accepting a URL to an untrusted destination. By padding the port number with zeros, an attacker can cause an integer overflow to occur when the URL authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for this issue. As a workaround, validate user input before parsing as a URI or, if possible, use Foundation's `URL` and `URLComponents` utilities.\n",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {
        "options": {
          "Automatable": "yes",
          "Exploitation": "none",
          "Technical Impact": "partial"
        },
        "version": "2.0.3"
      }
    },
    "references": [],
    "title": "Integer overflow in URI leading to potential host spoofing",
    "updated": "2024-09-18T16:12:29.182000+00:00",
    "vendors": [
      "vapor",
      "vapor$PRODUCT$vapor"
    ],
    "vulnrichment_repo_path": "2024/21xxx/CVE-2024-21631.json",
    "weaknesses": []
  }
}