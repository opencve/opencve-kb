{
  "cve": "CVE-2023-31999",
  "mitre": {
    "cpes": [],
    "created": "2023-07-04T16:29:20.281000+00:00",
    "description": "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\r\n\r\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2023/31xxx/CVE-2023-31999.json",
    "references": [
      "https://auth0.com/docs/secure/attack-protection/state-parameters",
      "https://github.com/fastify/fastify-oauth2/releases/tag/v7.2.0",
      "https://hackerone.com/reports/2020418"
    ],
    "title": null,
    "updated": "2024-08-02T15:03:28.687000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:fastify:oauth2:*:*:*:*:*:*:*:*"
    ],
    "created": "2023-07-04T17:15:10.657000+00:00",
    "description": "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\r\n\r\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 8.8,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2023/CVE-2023-31999.json",
    "references": [
      "https://auth0.com/docs/secure/attack-protection/state-parameters",
      "https://github.com/fastify/fastify-oauth2/releases/tag/v7.2.0",
      "https://hackerone.com/reports/2020418"
    ],
    "title": null,
    "updated": "2023-07-17T18:49:36.997000+00:00",
    "vendors": [
      "fastify",
      "fastify$PRODUCT$oauth2"
    ],
    "weaknesses": [
      "CWE-352"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:2.3:a:fastify:oauth2:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd"
      ]
    },
    "created": {
      "data": "2023-07-04T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\r\n\r\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 8.8,
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
        },
        "provider": "nvd"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://auth0.com/docs/secure/attack-protection/state-parameters",
        "https://github.com/fastify/fastify-oauth2/releases/tag/v7.2.0",
        "https://github.com/fastify/fastify-oauth2/security/advisories/GHSA-g8x5-p9qc-cf95",
        "https://hackerone.com/reports/2020418",
        "https://nvd.nist.gov/vuln/detail/CVE-2023-31999",
        "https://www.cve.org/CVERecord?id=CVE-2023-31999"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "fastify-oauth2: CSRF due to reused Oauth2 state",
      "provider": "nvd"
    },
    "updated": {
      "data": "2024-08-02T15:03:28.687000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "fastify",
        "fastify$PRODUCT$oauth2"
      ],
      "providers": [
        "nvd"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-352"
      ],
      "providers": [
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2023-07-04T00:00:00+00:00",
    "description": "All versions of @fastify/oauth2 used a statically generated state parameter at startup time and were used across all requests for all users. The purpose of the Oauth2 state parameter is to prevent Cross-Site-Request-Forgery attacks. As such, it should be unique per user and should be connected to the user's session in some way that will allow the server to validate it.\nv7.2.0 changes the default behavior to store the state in a cookie with the http-only and same-site=lax attributes set. The state is now by default generated for every user. Note that this contains a breaking change in the checkStateFunction function, which now accepts the full Request object.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 7.4,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2023/CVE-2023-31999.json",
    "references": [
      "https://github.com/fastify/fastify-oauth2/security/advisories/GHSA-g8x5-p9qc-cf95",
      "https://nvd.nist.gov/vuln/detail/CVE-2023-31999",
      "https://www.cve.org/CVERecord?id=CVE-2023-31999"
    ],
    "title": "fastify-oauth2: CSRF due to reused Oauth2 state",
    "updated": "2023-07-04T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-352"
    ]
  }
}