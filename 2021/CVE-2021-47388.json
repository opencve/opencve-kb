{
  "cve": "CVE-2021-47388",
  "mitre": {
    "cpes": [],
    "created": "2024-05-21T15:03:47.574000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmac80211: fix use-after-free in CCMP/GCMP RX\n\nWhen PN checking is done in mac80211, for fragmentation we need\nto copy the PN to the RX struct so we can later use it to do a\ncomparison, since commit bf30ca922a0c (\"mac80211: check defrag\nPN against current frame\").\n\nUnfortunately, in that commit I used the 'hdr' variable without\nit being necessarily valid, so use-after-free could occur if it\nwas necessary to reallocate (parts of) the frame.\n\nFix this by reloading the variable after the code that results\nin the reallocations, if any.\n\nThis fixes https://bugzilla.kernel.org/show_bug.cgi?id=214401.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/47xxx/CVE-2021-47388.json",
    "references": [
      "https://git.kernel.org/stable/c/27d3eb5616ee2c0a3b30c3fa34813368ed1f3dc9",
      "https://git.kernel.org/stable/c/31de381aef0ab1b342f62485118dc8a19363dc78",
      "https://git.kernel.org/stable/c/3d5d629c99c468458022e9b381789de3595bf4dd",
      "https://git.kernel.org/stable/c/447d001b875d0e7f211c4ba004916028da994258",
      "https://git.kernel.org/stable/c/50149e0866a82cef33e680ee68dc380a5bc75d32",
      "https://git.kernel.org/stable/c/57de2dcb18742dc2860861c9f496da7d42b67da0",
      "https://git.kernel.org/stable/c/94513069eb549737bcfc3d988d6ed4da948a2de8",
      "https://git.kernel.org/stable/c/f556e1d6fb9f2923a9a36f3df638c7d79ba09dbb"
    ],
    "title": "mac80211: fix use-after-free in CCMP/GCMP RX",
    "updated": "2024-08-04T05:39:58.947000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-05-21T15:15:24.257000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmac80211: fix use-after-free in CCMP/GCMP RX\n\nWhen PN checking is done in mac80211, for fragmentation we need\nto copy the PN to the RX struct so we can later use it to do a\ncomparison, since commit bf30ca922a0c (\"mac80211: check defrag\nPN against current frame\").\n\nUnfortunately, in that commit I used the 'hdr' variable without\nit being necessarily valid, so use-after-free could occur if it\nwas necessary to reallocate (parts of) the frame.\n\nFix this by reloading the variable after the code that results\nin the reallocations, if any.\n\nThis fixes https://bugzilla.kernel.org/show_bug.cgi?id=214401.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-47388.json",
    "references": [
      "https://git.kernel.org/stable/c/27d3eb5616ee2c0a3b30c3fa34813368ed1f3dc9",
      "https://git.kernel.org/stable/c/31de381aef0ab1b342f62485118dc8a19363dc78",
      "https://git.kernel.org/stable/c/3d5d629c99c468458022e9b381789de3595bf4dd",
      "https://git.kernel.org/stable/c/447d001b875d0e7f211c4ba004916028da994258",
      "https://git.kernel.org/stable/c/50149e0866a82cef33e680ee68dc380a5bc75d32",
      "https://git.kernel.org/stable/c/57de2dcb18742dc2860861c9f496da7d42b67da0",
      "https://git.kernel.org/stable/c/94513069eb549737bcfc3d988d6ed4da948a2de8",
      "https://git.kernel.org/stable/c/f556e1d6fb9f2923a9a36f3df638c7d79ba09dbb"
    ],
    "title": null,
    "updated": "2024-05-21T16:54:26.047000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-05-21T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nmac80211: fix use-after-free in CCMP/GCMP RX\n\nWhen PN checking is done in mac80211, for fragmentation we need\nto copy the PN to the RX struct so we can later use it to do a\ncomparison, since commit bf30ca922a0c (\"mac80211: check defrag\nPN against current frame\").\n\nUnfortunately, in that commit I used the 'hdr' variable without\nit being necessarily valid, so use-after-free could occur if it\nwas necessary to reallocate (parts of) the frame.\n\nFix this by reloading the variable after the code that results\nin the reallocations, if any.\n\nThis fixes https://bugzilla.kernel.org/show_bug.cgi?id=214401.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 6.4,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/27d3eb5616ee2c0a3b30c3fa34813368ed1f3dc9",
        "https://git.kernel.org/stable/c/31de381aef0ab1b342f62485118dc8a19363dc78",
        "https://git.kernel.org/stable/c/3d5d629c99c468458022e9b381789de3595bf4dd",
        "https://git.kernel.org/stable/c/447d001b875d0e7f211c4ba004916028da994258",
        "https://git.kernel.org/stable/c/50149e0866a82cef33e680ee68dc380a5bc75d32",
        "https://git.kernel.org/stable/c/57de2dcb18742dc2860861c9f496da7d42b67da0",
        "https://git.kernel.org/stable/c/94513069eb549737bcfc3d988d6ed4da948a2de8",
        "https://git.kernel.org/stable/c/f556e1d6fb9f2923a9a36f3df638c7d79ba09dbb",
        "https://lore.kernel.org/linux-cve-announce/2024052145-CVE-2021-47388-5715@gregkh/T",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-47388",
        "https://www.cve.org/CVERecord?id=CVE-2021-47388"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "mac80211: fix use-after-free in CCMP/GCMP RX",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T05:39:58.947000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-416"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-05-21T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nmac80211: fix use-after-free in CCMP/GCMP RX\nWhen PN checking is done in mac80211, for fragmentation we need\nto copy the PN to the RX struct so we can later use it to do a\ncomparison, since commit bf30ca922a0c (\"mac80211: check defrag\nPN against current frame\").\nUnfortunately, in that commit I used the 'hdr' variable without\nit being necessarily valid, so use-after-free could occur if it\nwas necessary to reallocate (parts of) the frame.\nFix this by reloading the variable after the code that results\nin the reallocations, if any.\nThis fixes https://bugzilla.kernel.org/show_bug.cgi?id=214401.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 6.4,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"
      },
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2021/CVE-2021-47388.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024052145-CVE-2021-47388-5715@gregkh/T",
      "https://nvd.nist.gov/vuln/detail/CVE-2021-47388",
      "https://www.cve.org/CVERecord?id=CVE-2021-47388"
    ],
    "title": "kernel: mac80211: fix use-after-free in CCMP/GCMP RX",
    "updated": "2024-05-21T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-416"
    ]
  }
}