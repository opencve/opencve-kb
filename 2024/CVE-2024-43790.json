{
  "cve": "CVE-2024-43790",
  "mitre": {
    "cpes": [],
    "created": "2024-08-22T21:23:07.797000+00:00",
    "description": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 4.5,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/43xxx/CVE-2024-43790.json",
    "references": [
      "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
      "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm"
    ],
    "title": "heap-buffer-overflow in do_search() in Vim < 9.1.0689",
    "updated": "2024-08-23T16:42:39.434000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-122"
    ]
  },
  "nvd": {
    "cpes": [],
    "created": "2024-08-22T22:15:05.317000+00:00",
    "description": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 4.5,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2024/CVE-2024-43790.json",
    "references": [
      "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
      "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm"
    ],
    "title": null,
    "updated": "2024-08-23T16:18:28.547000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-122"
    ]
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-08-22T21:45:00+00:00",
        "data": [
          {
            "details": {
              "new": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
              "old": null
            },
            "type": "description"
          },
          {
            "details": {
              "new": "heap-buffer-overflow in do_search() in Vim < 9.1.0689",
              "old": null
            },
            "type": "title"
          },
          {
            "details": {
              "added": [
                "CWE-122"
              ],
              "removed": []
            },
            "type": "weaknesses"
          },
          {
            "details": {
              "added": [
                "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
                "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {
                "cvssV3_1": {
                  "score": 4.5,
                  "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "b0110370-28e3-45cd-9cf2-376964dc3f0f"
      },
      {
        "created": "2024-08-23T01:15:00+00:00",
        "data": [
          {
            "details": {
              "added": [
                "https://nvd.nist.gov/vuln/detail/CVE-2024-43790",
                "https://www.cve.org/CVERecord?id=CVE-2024-43790"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {},
              "removed": {},
              "updated": {
                "threat_severity": {
                  "new": "Moderate",
                  "old": null
                }
              }
            },
            "type": "metrics"
          }
        ],
        "id": "13a2c2a7-f198-4b53-b4e7-c840215c6c86"
      },
      {
        "created": "2024-08-23T17:30:00+00:00",
        "data": [
          {
            "details": {
              "added": {
                "ssvc": {
                  "options": {
                    "Automatable": "no",
                    "Exploitation": "none",
                    "Technical Impact": "partial"
                  },
                  "version": "2.0.3"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "a41c0994-2e47-476a-b686-2556384a5273"
      }
    ],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-08-22T21:23:07.797000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 4.5,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {
          "options": {
            "Automatable": "no",
            "Exploitation": "none",
            "Technical Impact": "partial"
          },
          "version": "2.0.3"
        },
        "provider": "vulnrichment"
      },
      "threat_severity": {
        "data": "Moderate",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
        "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm",
        "https://nvd.nist.gov/vuln/detail/CVE-2024-43790",
        "https://www.cve.org/CVERecord?id=CVE-2024-43790"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "heap-buffer-overflow in do_search() in Vim < 9.1.0689",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-23T16:42:39.434000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-122"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-08-22T22:15:05+00:00",
    "description": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "threat_severity": "Moderate"
    },
    "redhat_repo_path": "2024/CVE-2024-43790.json",
    "references": [
      "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
      "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm",
      "https://nvd.nist.gov/vuln/detail/CVE-2024-43790",
      "https://www.cve.org/CVERecord?id=CVE-2024-43790"
    ],
    "title": "vim: Out of bounds read when performing a search command",
    "updated": "2024-08-22T22:15:05+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-122"
    ]
  },
  "vulnrichment": {
    "cpes": [],
    "created": "2024-08-22T21:23:07.797000+00:00",
    "description": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {
        "options": {
          "Automatable": "no",
          "Exploitation": "none",
          "Technical Impact": "partial"
        },
        "version": "2.0.3"
      }
    },
    "references": [],
    "title": "heap-buffer-overflow in do_search() in Vim < 9.1.0689",
    "updated": "2024-08-23T16:42:35.521000+00:00",
    "vendors": [],
    "vulnrichment_repo_path": "2024/43xxx/CVE-2024-43790.json",
    "weaknesses": []
  }
}