{
  "cve": "CVE-2021-47576",
  "mitre": {
    "cpes": [],
    "created": "2024-06-19T14:53:44.725000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()\n\nIn resp_mode_select() sanity check the block descriptor len to avoid UAF.\n\nBUG: KASAN: use-after-free in resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\nRead of size 1 at addr ffff888026670f50 by task scsicmd/15032\n\nCPU: 1 PID: 15032 Comm: scsicmd Not tainted 5.15.0-01d0625 #15\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nCall Trace:\n <TASK>\n dump_stack_lvl+0x89/0xb5 lib/dump_stack.c:107\n print_address_description.constprop.9+0x28/0x160 mm/kasan/report.c:257\n kasan_report.cold.14+0x7d/0x117 mm/kasan/report.c:443\n __asan_report_load1_noabort+0x14/0x20 mm/kasan/report_generic.c:306\n resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\n schedule_resp+0x4af/0x1a10 drivers/scsi/scsi_debug.c:5483\n scsi_debug_queuecommand+0x8c9/0x1e70 drivers/scsi/scsi_debug.c:7537\n scsi_queue_rq+0x16b4/0x2d10 drivers/scsi/scsi_lib.c:1521\n blk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1640\n __blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\n blk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n __blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1762\n __blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1839\n blk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\n blk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\n blk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:63\n sg_common_write.isra.18+0xeb3/0x2000 drivers/scsi/sg.c:837\n sg_new_write.isra.19+0x570/0x8c0 drivers/scsi/sg.c:775\n sg_ioctl_common+0x14d6/0x2710 drivers/scsi/sg.c:941\n sg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1166\n __x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:52\n do_syscall_64+0x3a/0x80 arch/x86/entry/common.c:50\n entry_SYSCALL_64_after_hwframe+0x44/0xae arch/x86/entry/entry_64.S:113",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2021/47xxx/CVE-2021-47576.json",
    "references": [
      "https://git.kernel.org/stable/c/04181973c38f3d6a353f9246dcf7fee08024fd9e",
      "https://git.kernel.org/stable/c/90491283b4064220682e4b0687d07b05df01e3bf",
      "https://git.kernel.org/stable/c/a9078e791426c2cbbdf28a320c3670f6e0a611e6",
      "https://git.kernel.org/stable/c/adcecd50da6cab7b4957cba0606771dcc846c5a9",
      "https://git.kernel.org/stable/c/b847ecff850719c46c95acd25a0d555dfd16e10d",
      "https://git.kernel.org/stable/c/dfc3fff63793c571147930b13c0f8c689c4281ac",
      "https://git.kernel.org/stable/c/e0a2c28da11e2c2b963fc01d50acbf03045ac732"
    ],
    "title": "scsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()",
    "updated": "2024-08-04T05:39:59.644000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "nvd": {
    "cpes": [],
    "created": "2024-06-19T15:15:52.117000+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()\n\nIn resp_mode_select() sanity check the block descriptor len to avoid UAF.\n\nBUG: KASAN: use-after-free in resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\nRead of size 1 at addr ffff888026670f50 by task scsicmd/15032\n\nCPU: 1 PID: 15032 Comm: scsicmd Not tainted 5.15.0-01d0625 #15\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nCall Trace:\n <TASK>\n dump_stack_lvl+0x89/0xb5 lib/dump_stack.c:107\n print_address_description.constprop.9+0x28/0x160 mm/kasan/report.c:257\n kasan_report.cold.14+0x7d/0x117 mm/kasan/report.c:443\n __asan_report_load1_noabort+0x14/0x20 mm/kasan/report_generic.c:306\n resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\n schedule_resp+0x4af/0x1a10 drivers/scsi/scsi_debug.c:5483\n scsi_debug_queuecommand+0x8c9/0x1e70 drivers/scsi/scsi_debug.c:7537\n scsi_queue_rq+0x16b4/0x2d10 drivers/scsi/scsi_lib.c:1521\n blk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1640\n __blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\n blk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n __blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1762\n __blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1839\n blk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\n blk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\n blk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:63\n sg_common_write.isra.18+0xeb3/0x2000 drivers/scsi/sg.c:837\n sg_new_write.isra.19+0x570/0x8c0 drivers/scsi/sg.c:775\n sg_ioctl_common+0x14d6/0x2710 drivers/scsi/sg.c:941\n sg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1166\n __x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:52\n do_syscall_64+0x3a/0x80 arch/x86/entry/common.c:50\n entry_SYSCALL_64_after_hwframe+0x44/0xae arch/x86/entry/entry_64.S:113",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2021/CVE-2021-47576.json",
    "references": [
      "https://git.kernel.org/stable/c/04181973c38f3d6a353f9246dcf7fee08024fd9e",
      "https://git.kernel.org/stable/c/90491283b4064220682e4b0687d07b05df01e3bf",
      "https://git.kernel.org/stable/c/a9078e791426c2cbbdf28a320c3670f6e0a611e6",
      "https://git.kernel.org/stable/c/adcecd50da6cab7b4957cba0606771dcc846c5a9",
      "https://git.kernel.org/stable/c/b847ecff850719c46c95acd25a0d555dfd16e10d",
      "https://git.kernel.org/stable/c/dfc3fff63793c571147930b13c0f8c689c4281ac",
      "https://git.kernel.org/stable/c/e0a2c28da11e2c2b963fc01d50acbf03045ac732"
    ],
    "title": null,
    "updated": "2024-06-20T12:43:25.663000+00:00",
    "vendors": [],
    "weaknesses": []
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [],
      "providers": []
    },
    "created": {
      "data": "2024-06-19T00:00:00+00:00",
      "provider": "redhat"
    },
    "description": {
      "data": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()\n\nIn resp_mode_select() sanity check the block descriptor len to avoid UAF.\n\nBUG: KASAN: use-after-free in resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\nRead of size 1 at addr ffff888026670f50 by task scsicmd/15032\n\nCPU: 1 PID: 15032 Comm: scsicmd Not tainted 5.15.0-01d0625 #15\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nCall Trace:\n <TASK>\n dump_stack_lvl+0x89/0xb5 lib/dump_stack.c:107\n print_address_description.constprop.9+0x28/0x160 mm/kasan/report.c:257\n kasan_report.cold.14+0x7d/0x117 mm/kasan/report.c:443\n __asan_report_load1_noabort+0x14/0x20 mm/kasan/report_generic.c:306\n resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\n schedule_resp+0x4af/0x1a10 drivers/scsi/scsi_debug.c:5483\n scsi_debug_queuecommand+0x8c9/0x1e70 drivers/scsi/scsi_debug.c:7537\n scsi_queue_rq+0x16b4/0x2d10 drivers/scsi/scsi_lib.c:1521\n blk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1640\n __blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\n blk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n __blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1762\n __blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1839\n blk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\n blk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\n blk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:63\n sg_common_write.isra.18+0xeb3/0x2000 drivers/scsi/sg.c:837\n sg_new_write.isra.19+0x570/0x8c0 drivers/scsi/sg.c:775\n sg_ioctl_common+0x14d6/0x2710 drivers/scsi/sg.c:941\n sg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1166\n __x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:52\n do_syscall_64+0x3a/0x80 arch/x86/entry/common.c:50\n entry_SYSCALL_64_after_hwframe+0x44/0xae arch/x86/entry/entry_64.S:113",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5.2,
          "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
        },
        "provider": "redhat"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": "Low",
        "provider": "redhat"
      }
    },
    "references": {
      "data": [
        "https://git.kernel.org/stable/c/04181973c38f3d6a353f9246dcf7fee08024fd9e",
        "https://git.kernel.org/stable/c/90491283b4064220682e4b0687d07b05df01e3bf",
        "https://git.kernel.org/stable/c/a9078e791426c2cbbdf28a320c3670f6e0a611e6",
        "https://git.kernel.org/stable/c/adcecd50da6cab7b4957cba0606771dcc846c5a9",
        "https://git.kernel.org/stable/c/b847ecff850719c46c95acd25a0d555dfd16e10d",
        "https://git.kernel.org/stable/c/dfc3fff63793c571147930b13c0f8c689c4281ac",
        "https://git.kernel.org/stable/c/e0a2c28da11e2c2b963fc01d50acbf03045ac732",
        "https://lore.kernel.org/linux-cve-announce/2024061914-CVE-2021-47576-5f60@gregkh/T",
        "https://nvd.nist.gov/vuln/detail/CVE-2021-47576",
        "https://www.cve.org/CVERecord?id=CVE-2021-47576"
      ],
      "providers": [
        "mitre",
        "nvd",
        "redhat"
      ]
    },
    "title": {
      "data": "scsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-04T05:39:59.644000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [],
      "providers": []
    },
    "weaknesses": {
      "data": [
        "CWE-416"
      ],
      "providers": [
        "redhat"
      ]
    }
  },
  "redhat": {
    "cpes": [],
    "created": "2024-06-19T00:00:00+00:00",
    "description": "In the Linux kernel, the following vulnerability has been resolved:\nscsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()\nIn resp_mode_select() sanity check the block descriptor len to avoid UAF.\nBUG: KASAN: use-after-free in resp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\nRead of size 1 at addr ffff888026670f50 by task scsicmd/15032\nCPU: 1 PID: 15032 Comm: scsicmd Not tainted 5.15.0-01d0625 #15\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nCall Trace:\n<TASK>\ndump_stack_lvl+0x89/0xb5 lib/dump_stack.c:107\nprint_address_description.constprop.9+0x28/0x160 mm/kasan/report.c:257\nkasan_report.cold.14+0x7d/0x117 mm/kasan/report.c:443\n__asan_report_load1_noabort+0x14/0x20 mm/kasan/report_generic.c:306\nresp_mode_select+0xa4c/0xb40 drivers/scsi/scsi_debug.c:2509\nschedule_resp+0x4af/0x1a10 drivers/scsi/scsi_debug.c:5483\nscsi_debug_queuecommand+0x8c9/0x1e70 drivers/scsi/scsi_debug.c:7537\nscsi_queue_rq+0x16b4/0x2d10 drivers/scsi/scsi_lib.c:1521\nblk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1640\n__blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325\nblk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358\n__blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1762\n__blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1839\nblk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891\nblk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474\nblk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:63\nsg_common_write.isra.18+0xeb3/0x2000 drivers/scsi/sg.c:837\nsg_new_write.isra.19+0x570/0x8c0 drivers/scsi/sg.c:775\nsg_ioctl_common+0x14d6/0x2710 drivers/scsi/sg.c:941\nsg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1166\n__x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:52\ndo_syscall_64+0x3a/0x80 arch/x86/entry/common.c:50\nentry_SYSCALL_64_after_hwframe+0x44/0xae arch/x86/entry/entry_64.S:113",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.2,
        "vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H"
      },
      "threat_severity": "Low"
    },
    "redhat_repo_path": "2021/CVE-2021-47576.json",
    "references": [
      "https://lore.kernel.org/linux-cve-announce/2024061914-CVE-2021-47576-5f60@gregkh/T",
      "https://nvd.nist.gov/vuln/detail/CVE-2021-47576",
      "https://www.cve.org/CVERecord?id=CVE-2021-47576"
    ],
    "title": "kernel: scsi: scsi_debug: Sanity check block descriptor length in resp_mode_select()",
    "updated": "2024-06-19T00:00:00+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-416"
    ]
  }
}