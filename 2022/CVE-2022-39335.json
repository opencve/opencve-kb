{
  "cve": "CVE-2022-39335",
  "mitre": {
    "cpes": [],
    "created": "2023-05-26T13:36:56.436000+00:00",
    "description": "Synapse is an open-source Matrix homeserver written and maintained by the Matrix.org Foundation. The Matrix Federation API allows remote homeservers to request the authorization events in a room. This is necessary so that a homeserver receiving some events can validate that those events are legitimate and permitted in their room. However, in versions of Synapse up to and including 1.68.0, a Synapse homeserver answering a query for authorization events does not sufficiently check that the requesting server should be able to access them. The issue was patched in Synapse 1.69.0. Homeserver administrators are advised to upgrade.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2022/39xxx/CVE-2022-39335.json",
    "references": [
      "https://github.com/matrix-org/synapse/issues/13288",
      "https://github.com/matrix-org/synapse/pull/13823",
      "https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv",
      "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T2MBNMZAFY4RCZL2VGBGAPKGB4JUPZVS/"
    ],
    "title": "Synapse does not apply enough checks to servers requesting auth events of events in a room",
    "updated": "2024-08-03T12:00:44.102000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-200"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*"
    ],
    "created": "2023-05-26T14:15:09.600000+00:00",
    "description": "Synapse is an open-source Matrix homeserver written and maintained by the Matrix.org Foundation. The Matrix Federation API allows remote homeservers to request the authorization events in a room. This is necessary so that a homeserver receiving some events can validate that those events are legitimate and permitted in their room. However, in versions of Synapse up to and including 1.68.0, a Synapse homeserver answering a query for authorization events does not sufficiently check that the requesting server should be able to access them. The issue was patched in Synapse 1.69.0. Homeserver administrators are advised to upgrade.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {
        "score": 5.0,
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2022/CVE-2022-39335.json",
    "references": [
      "https://github.com/matrix-org/synapse/issues/13288",
      "https://github.com/matrix-org/synapse/pull/13823",
      "https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv",
      "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T2MBNMZAFY4RCZL2VGBGAPKGB4JUPZVS/"
    ],
    "title": null,
    "updated": "2023-06-11T04:15:46.950000+00:00",
    "vendors": [
      "matrix",
      "matrix$PRODUCT$synapse"
    ],
    "weaknesses": [
      "CWE-200",
      "CWE-862"
    ]
  },
  "opencve": {
    "changes": [],
    "cpes": {
      "data": [
        "cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd"
      ]
    },
    "created": {
      "data": "2023-05-26T13:36:56.436000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "Synapse is an open-source Matrix homeserver written and maintained by the Matrix.org Foundation. The Matrix Federation API allows remote homeservers to request the authorization events in a room. This is necessary so that a homeserver receiving some events can validate that those events are legitimate and permitted in their room. However, in versions of Synapse up to and including 1.68.0, a Synapse homeserver answering a query for authorization events does not sufficiently check that the requesting server should be able to access them. The issue was patched in Synapse 1.69.0. Homeserver administrators are advised to upgrade.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_1": {
        "data": {
          "score": 5,
          "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L"
        },
        "provider": "mitre"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {},
        "provider": null
      },
      "threat_severity": {
        "data": null,
        "provider": null
      }
    },
    "references": {
      "data": [
        "https://github.com/matrix-org/synapse/issues/13288",
        "https://github.com/matrix-org/synapse/pull/13823",
        "https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv",
        "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T2MBNMZAFY4RCZL2VGBGAPKGB4JUPZVS/"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    },
    "title": {
      "data": "Synapse does not apply enough checks to servers requesting auth events of events in a room",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-08-03T12:00:44.102000+00:00",
      "provider": "mitre"
    },
    "vendors": {
      "data": [
        "matrix",
        "matrix$PRODUCT$synapse"
      ],
      "providers": [
        "nvd"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-200",
        "CWE-862"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    }
  }
}