{
  "cve": "CVE-2024-6087",
  "mitre": {
    "cpes": [],
    "created": "2024-09-13T16:12:15.921000+00:00",
    "description": "An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the 'invite user' functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {
        "score": 6.5,
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
      },
      "cvssV3_1": {},
      "cvssV4_0": {}
    },
    "mitre_repo_path": "cves/2024/6xxx/CVE-2024-6087.json",
    "references": [
      "https://github.com/lunary-ai/lunary/commit/844e8855c7a713dc7371766dba4125de4007b1cf",
      "https://huntr.com/bounties/bd9f2301-11c7-4cbd-8d77-3e9225bd67e8"
    ],
    "title": "Improper Access Control in lunary-ai/lunary",
    "updated": "2024-09-13T16:40:45.803000+00:00",
    "vendors": [],
    "weaknesses": [
      "CWE-284"
    ]
  },
  "nvd": {
    "cpes": [
      "cpe:2.3:a:lunary:lunary:*:*:*:*:*:*:*:*"
    ],
    "created": "2024-09-13T17:15:13.027000+00:00",
    "description": "An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the 'invite user' functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {
        "score": 6.5,
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
      },
      "cvssV3_1": {
        "score": 6.5,
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
      },
      "cvssV4_0": {}
    },
    "nvd_repo_path": "2024/CVE-2024-6087.json",
    "references": [
      "https://github.com/lunary-ai/lunary/commit/844e8855c7a713dc7371766dba4125de4007b1cf",
      "https://huntr.com/bounties/bd9f2301-11c7-4cbd-8d77-3e9225bd67e8"
    ],
    "title": null,
    "updated": "2024-09-19T19:32:14.710000+00:00",
    "vendors": [
      "lunary",
      "lunary$PRODUCT$lunary"
    ],
    "weaknesses": [
      "CWE-284",
      "NVD-CWE-Other"
    ]
  },
  "opencve": {
    "changes": [
      {
        "created": "2024-09-13T16:30:00+00:00",
        "data": [
          {
            "details": {
              "new": "An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the 'invite user' functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.",
              "old": null
            },
            "type": "description"
          },
          {
            "details": {
              "new": "Improper Access Control in lunary-ai/lunary",
              "old": null
            },
            "type": "title"
          },
          {
            "details": {
              "added": [
                "CWE-284"
              ],
              "removed": []
            },
            "type": "weaknesses"
          },
          {
            "details": {
              "added": [
                "https://github.com/lunary-ai/lunary/commit/844e8855c7a713dc7371766dba4125de4007b1cf",
                "https://huntr.com/bounties/bd9f2301-11c7-4cbd-8d77-3e9225bd67e8"
              ],
              "removed": []
            },
            "type": "references"
          },
          {
            "details": {
              "added": {
                "cvssV3_0": {
                  "score": 6.5,
                  "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "b9a77d0a-5b92-4502-809a-05f4b9226de6"
      },
      {
        "created": "2024-09-13T17:30:00+00:00",
        "data": [
          {
            "details": [
              "lunary-ai",
              "lunary-ai$PRODUCT$lunary-ai\\/lunary"
            ],
            "type": "first_time"
          },
          {
            "details": {
              "added": [
                "cpe:2.3:a:lunary-ai:lunary-ai\\/lunary:*:*:*:*:*:*:*:*"
              ],
              "removed": []
            },
            "type": "cpes"
          },
          {
            "details": {
              "added": [
                "lunary-ai",
                "lunary-ai$PRODUCT$lunary-ai\\/lunary"
              ],
              "removed": []
            },
            "type": "vendors"
          },
          {
            "details": {
              "added": {
                "ssvc": {
                  "options": {
                    "Automatable": "no",
                    "Exploitation": "poc",
                    "Technical Impact": "partial"
                  },
                  "version": "2.0.3"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "87743541-533f-4a59-a187-0d154be6c95a"
      },
      {
        "created": "2024-09-19T20:00:00+00:00",
        "data": [
          {
            "details": [
              "lunary",
              "lunary$PRODUCT$lunary"
            ],
            "type": "first_time"
          },
          {
            "details": {
              "added": [
                "NVD-CWE-Other"
              ],
              "removed": []
            },
            "type": "weaknesses"
          },
          {
            "details": {
              "added": [
                "cpe:2.3:a:lunary:lunary:*:*:*:*:*:*:*:*"
              ],
              "removed": []
            },
            "type": "cpes"
          },
          {
            "details": {
              "added": [
                "lunary",
                "lunary$PRODUCT$lunary"
              ],
              "removed": []
            },
            "type": "vendors"
          },
          {
            "details": {
              "added": {
                "cvssV3_1": {
                  "score": 6.5,
                  "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
                }
              },
              "removed": {},
              "updated": {}
            },
            "type": "metrics"
          }
        ],
        "id": "99cf5434-4577-4666-acac-24411b76355c"
      }
    ],
    "cpes": {
      "data": [
        "cpe:2.3:a:lunary-ai:lunary-ai\\/lunary:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:lunary:lunary:*:*:*:*:*:*:*:*"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "created": {
      "data": "2024-09-13T16:12:15.921000+00:00",
      "provider": "mitre"
    },
    "description": {
      "data": "An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the 'invite user' functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.",
      "provider": "mitre"
    },
    "metrics": {
      "cvssV2_0": {
        "data": {},
        "provider": null
      },
      "cvssV3_0": {
        "data": {
          "score": 6.5,
          "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
        },
        "provider": "mitre"
      },
      "cvssV3_1": {
        "data": {
          "score": 6.5,
          "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N"
        },
        "provider": "nvd"
      },
      "cvssV4_0": {
        "data": {},
        "provider": null
      },
      "kev": {
        "data": {},
        "provider": null
      },
      "ssvc": {
        "data": {
          "options": {
            "Automatable": "no",
            "Exploitation": "poc",
            "Technical Impact": "partial"
          },
          "version": "2.0.3"
        },
        "provider": "vulnrichment"
      },
      "threat_severity": {
        "data": null,
        "provider": null
      }
    },
    "references": {
      "data": [
        "https://github.com/lunary-ai/lunary/commit/844e8855c7a713dc7371766dba4125de4007b1cf",
        "https://huntr.com/bounties/bd9f2301-11c7-4cbd-8d77-3e9225bd67e8"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    },
    "title": {
      "data": "Improper Access Control in lunary-ai/lunary",
      "provider": "mitre"
    },
    "updated": {
      "data": "2024-09-19T19:32:14.710000+00:00",
      "provider": "nvd"
    },
    "vendors": {
      "data": [
        "lunary",
        "lunary$PRODUCT$lunary",
        "lunary-ai",
        "lunary-ai$PRODUCT$lunary-ai\\/lunary"
      ],
      "providers": [
        "nvd",
        "vulnrichment"
      ]
    },
    "weaknesses": {
      "data": [
        "CWE-284",
        "NVD-CWE-Other"
      ],
      "providers": [
        "mitre",
        "nvd"
      ]
    }
  },
  "vulnrichment": {
    "cpes": [
      "cpe:2.3:a:lunary-ai:lunary-ai\\/lunary:*:*:*:*:*:*:*:*"
    ],
    "created": "2024-09-13T16:12:15.921000+00:00",
    "description": "An improper access control vulnerability exists in lunary-ai/lunary at the latest commit (a761d83) on the main branch. The vulnerability allows an attacker to use the auth tokens issued by the 'invite user' functionality to obtain valid JWT tokens. These tokens can be used to compromise target users upon registration for their own arbitrary organizations. The attacker can invite a target email, obtain a one-time use token, retract the invite, and later use the token to reset the password of the target user, leading to full account takeover.",
    "metrics": {
      "cvssV2_0": {},
      "cvssV3_0": {},
      "cvssV3_1": {},
      "cvssV4_0": {},
      "kev": {},
      "ssvc": {
        "options": {
          "Automatable": "no",
          "Exploitation": "poc",
          "Technical Impact": "partial"
        },
        "version": "2.0.3"
      }
    },
    "references": [],
    "title": "Improper Access Control in lunary-ai/lunary",
    "updated": "2024-09-13T16:40:36.674000+00:00",
    "vendors": [
      "lunary-ai",
      "lunary-ai$PRODUCT$lunary-ai\\/lunary"
    ],
    "vulnrichment_repo_path": "2024/6xxx/CVE-2024-6087.json",
    "weaknesses": []
  }
}